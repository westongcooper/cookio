YUI.add("flickr-photos-getAllContexts-fetcher",function(e,t){"use strict";function n(t){var n;return n={photo_id:t.id,extras:e.APIHelper.request.getRebootPhotoExtras()+","+e.APIHelper.request.getRebootGroupExtras()+","+e.APIHelper.request.getRebootAlbumsListExtras(),primary_photo_extras:"url_sq, url_t, url_s, url_m, needs_interstitial"},t.scrappy&&(n.get_all_galleries=1,n.no_faves_context=1,n.per_type_limit=6,n.get_totals=1,n.sort="date-desc"),n}function r(t,n){var r=t[0],i=t[1],s=t[2],o={},u=[],a,f=t[8],l=t[9],c=t[10],h=t[11],p;return o.faves=t[3],o.gallery=t[4],o.pool=t[5],o.set=t[6],o.stream=t[7],e.Object.each(o,function(t,n){r[n]&&e.Array.each(r[n],function(n){e.APIHelper.response.addContextToRegistry(n,t,i,h),u.push(t.proxy(n.id))})}),s.exists(n.id)||(a=s.add({id:n.id,totalGroups:r.totals&&r.totals.groups,totalSets:r.totals&&r.totals.sets,totalGalleries:r.totals&&r.totals.galleries}),s.setValue(n.id,"contexts",u)),f.addOrUpdate({id:n.id,total:r.totals&&r.totals.groups,groups:s.getContextsOfType(n.id,"group-pool-models")}),p=s.getContextsOfType(n.id,"set-models"),p.forEach(function(e){e.setValue("totalCount",parseInt(e.getValue("photoCount"),10)+parseInt(e.getValue("videoCount"),10))}),l.addOrUpdate({id:n.id,total:r.totals&&r.totals.sets,sets:p}),c.addOrUpdate({id:n.id,total:r.totals&&r.totals.galleries,galleries:s.getContextsOfType(n.id,"gallery-models")}),a}function i(n,r){var i=this;return r.flipper.isFlipped("enable-scrappy-photo-page")&&(n.scrappy=!0),e.Promise.all([r.callAPI("flickr.photos.getAllContexts",this._processParams(n),!0),r.getModelRegistry("person-models"),r.getModelRegistry("photo-contexts-models"),r.getModelRegistry("favorite-models"),r.getModelRegistry("gallery-models"),r.getModelRegistry("group-pool-models"),r.getModelRegistry("set-models"),r.getModelRegistry("photostream-models"),r.getModelRegistry("photo-groups-models"),r.getModelRegistry("photo-sets-models"),r.getModelRegistry("photo-galleries-models"),r.getModelRegistry("group-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-photos-getAllContexts"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-contexts-models","favorite-models","gallery-models","group-pool-models","photostream-models","set-models","photo-groups-models","photo-sets-models","photo-galleries-models","group-models"]});
YUI.add("photo-sets-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getAllContexts"].run(t,this.appContext)}},attributes:{id:{},sets:{isListProxy:!0},total:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0}}})},"@VERSION@",{requires:["api-helper","flickr-model-registry","flickr-promise","flickr-photos-getAllContexts-fetcher"]});
YUI.add("flickr-photosets-addPhoto-creator",function(e,t){"use strict";function n(n,r){var i={full_response:1},s=[],o=n.isMultiplePhotos?"photo_ids":"photo_id",u=n.photoID.split(",").length;return i[o]=n.photoID,i.photoset_id=n.setID,n.gpCode&&(i.gp_code=n.gpCode),n.gpOwner&&(i.gp_owner=n.gpOwner),n.shareCode&&(i.share_code=n.shareCode),s=[r.callAPI("flickr.photosets.addPhoto",i),r.getModel("set-models",n.setID),r.getModelRegistry("photo-sets-models"),r.getModelRegistry("photo-contexts-models")],n.isMultiplePhotos||s.push(r.getModel("photo-models",n.photoID)),e.Promise.all(s).then(function(e){var t=e[0],r=e[1],i=e[2],s=e[3],o,a=t.errors,f=t.errors?t.errors.length:0;u-=f;if(t.stat==="ok")return n.isMultiplePhotos?r&&n.updateItemCounts&&(r.setValue("photoCount",r.getValue("photoCount")+n.numberOfPhotosSelected),r.setValue("videoCount",r.getValue("videoCount")+n.numberOfVideosSelected)):(o=e[4],r&&!r.hasPhoto(o.getValue("id"))&&(r.addPhoto(o),o.getValue("isVideo")?r.setValue("videoCount",r.getValue("videoCount")+1):r.setValue("photoCount",r.getValue("photoCount")+1))),i.exists(n.photoID)&&!i.getValue(n.photoID,"sets").getFromListByID(r.getValue("id"))&&(i.getValue(n.photoID,"sets").prependToList(r),i.setValue(n.photoID,"total",i.getValue(n.photoID,"total")+u)),s.exists(n.photoID)&&!s.getValue(n.photoID,"contexts").getFromListByID(r.getValue("id"))&&(s.setValue(n.photoID,"totalSets",s.getValue(n.photoID,"totalSets")+u),s.getValue(n.photoID,"contexts").push(r)),n.isMultiplePhotos?(f&&a.forEach(function(e){n.photosSelectedIds.indexOf(e.photo_id)!==-1?r.setValue("photoCount",r.getValue("photoCount")-1):r.setValue("videoCount",r.getValue("videoCount")-1)}),{errors:a,setModel:r}):r},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-photosets-addPhoto"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:["set-models","photo-models","photo-sets-models","photo-contexts-models"]});
YUI.add("flickr-photosets-getList-fetcher",function(e,t){"use strict";function n(t){var n={primary_photo_extras:e.APIHelper.request.getRebootAlbumsListExtras(),page:t.page||1,per_page:t.perPage||500,get_user_info:1,extras:"can_share,can_download"};if(t.id)n.user_id=t.id;else{if(!t.pathAlias)throw new Error("[flickr-favorites-getList-fetcher] `id` or `pathAlias` is required.");n.path_alias=t.pathAlias}return n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=r.photosets,a={},f=o.getValue("id"),l=[];if(u)return u.photoset&&e.Array.each(u.photoset,function(t,n){if(t.visibilityCanSeeSet!==0){var r={id:t.id,title:t.title.content,description:t.description.content,owner:o,primary:t.primary,primaryPhotoSizes:e.APIHelper.response.parsePrimaryPhotoSizes(t),isAutoUploadSet:t.autoUpload,primaryNeedsInterstitial:t.needsInterstitial,photoCount:t.photos,videoCount:t.videos,totalCount:parseInt(t.photos,10)+parseInt(t.videos,10),viewCount:t.countViews,canShare:t.canShare,canDownload:t.canDownload};l.push(s.addOrUpdate(r))}}),a={id:f,pathAlias:o.getValue("pathAlias"),totalItems:r.photosets.total},a.albumsList={perPage:n.perPage,page:n.page,pageContent:l,totalItems:r.photosets.total},i.addOrUpdate(a),l}function i(n,r){var i=this,s=this._processParams(n);return e.Promise.all([r.callAPI("flickr.photosets.getList",s,!0),r.getModelRegistry("sets-models"),r.getModelRegistry("set-models"),r.getModel("person-models",n.id||{pathAlias:n.pathAlias})]).then(function(e){return n.perPage=s.per_page,n.page=s.page,i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-photosets-getList"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["sets-models","set-models","person-models"]});
YUI.add("sets-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-photosets-getList"].run(t,this.appContext)}},attributes:{id:{},pathAlias:{},albumsList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-photosets-getList"]}},totalItems:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photosets-getList-fetcher"]});
YUI.add("flickr-photosets-removePhoto-deletor",function(e,t){"use strict";function n(n,r){var i={full_response:1},s=[],o=n.isMultiplePhotos?"photo_ids":"photo_id",u=n.photoID.split(",").length;return i[o]=n.photoID,i.photoset_id=n.setID,s=[r.callAPI("flickr.photosets.removePhoto",i),r.getModel("set-models",n.setID),r.getModel("sets-models",r.getViewer().nsid),r.getModelRegistry("photo-sets-models"),r.getModelRegistry("photo-contexts-models")],n.isMultiplePhotos||s.push(r.getModel("photo-models",n.photoID)),e.Promise.all(s).then(function(e){var t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a;if(t.stat==="ok"){o.exists(n.photoID)&&o.getValue(n.photoID,"contexts").getFromListByID(n.setID)&&(o.setValue(n.photoID,"totalSets",o.getValue(n.photoID,"totalSets")-u),o.getValue(n.photoID,"contexts").removeFromList(n.setID)),s.exists(n.photoID)&&s.getValue(n.photoID,"sets").getFromListByID(n.setID)&&(s.setValue(n.photoID,"total",s.getValue(n.photoID,"total")-u),s.getValue(n.photoID,"sets").removeFromList(n.setID));if(r){n.isMultiplePhotos?r&&n.updateItemCounts&&(r.setValue("photoCount",r.getValue("photoCount")-n.numberOfPhotosSelected),r.setValue("videoCount",r.getValue("videoCount")-n.numberOfVideosSelected)):(a=e[5],r.hasPhoto(a.getValue("id"))&&r.removePhoto(a),a.getValue("isVideo")?r.setValue("videoCount",r.getValue("videoCount")-u):r.setValue("photoCount",r.getValue("photoCount")-u));if(r.getValue("totalCount")<1)return i.getValue("albumsList").remove(n.setID),r.registry.remove(n.setID),null}return r}},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-photosets-removePhoto"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:["set-models","photo-models","sets-models","photo-sets-models","photo-contexts-models"]});
YUI.add("flickr-photosets-delete-deletor",function(e,t){"use strict";function n(n,r){return n.photoset_id=n.setID,n.gpCode&&(n.gp_code=n.gpCode),n.gpOwner&&(n.gp_owner=n.gpOwner),n.shareCode&&(n.share_code=n.shareCode),r.callAPI("flickr.photosets.delete",n).then(function(e){if(e.code===1)throw new Error(e)}).catch(e.FetcherErrorLogger(t))}e.namespace("ModelDeletors")["flickr-photosets-delete-deletor"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-photosets-getPhotos-fetcher",function(e,t){"use strict";function n(t){t.page=t.page||1,t.perPage=t.perPage||100;var n={extras:e.APIHelper.request.getRebootPhotoExtras(),per_page:t.perPage,page:t.page,get_user_info:1,primary_photo_extras:"url_c, url_h, url_k, url_l, url_m, url_n, url_o, url_q, url_s, url_sq, url_t, url_z, needs_interstitial, can_share",jump_to:t.withPhotoId||""};return t.gpCode&&t.gpCode!==null?(n.gp_code=t.gpCode,n.share_code=t.gpCode,n.gp_owner=t.gpOwner):n.photoset_id=t.id.split("-")[0],t.viewAs&&(n.view_as=t.viewAs),t.filter&&(n.privacy_filter=t.filter),n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=t[7],c,h,p,d,v,m=[],g=!1,y=!1,b=n.id;c=e.APIHelper.response.parsePerson(r.user),h=s.addOrUpdate(c),p={id:n.id,title:r.photoset.title,description:r.photoset.description,owner:h,primary:r.photoset.primary,primaryPhotoSizes:e.APIHelper.response.parsePrimaryPhotoSizes(r.photoset),isAutoUploadSet:r.photoset.isAutoUploadSet,isSharedEntity:r.photoset.hidden&&r.photoset.hidden===1?!0:!1,photoCount:r.photoset.photoCount,videoCount:r.photoset.videoCount,primaryNeedsInterstitial:r.photoset.needsInterstitial,totalCount:parseInt(r.photoset.photoCount,10)+parseInt(r.photoset.videoCount,10),photoList:[],viewCount:r.photoset.countViews,canShare:r.photoset.canShare,canDownload:r.photoset.canDownload},b&&b!==r.photoset.id&&(p.id=b),r.photoset.isAutoUploadSet==="1"&&(p.canShare=!1),o.exists(n.id)&&(d=o.getValue(n.id,"photoPageList"),g=d.hasMinBoundary?d.hasMinBoundary():!1,y=d.hasMaxBoundary?d.hasMaxBoundary():!1,m=d.getList()),v=e.APIHelper.response.parsePhotos({photos:r.photoset.photo,ownerID:r.photoset.owner,personModelRegistry:s,photoModelRegistry:i,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),p.photoPageList=e.APIHelper.response.addOrReplaceListByPage({current:m,perPage:n.perPage,pageNum:n.page,hasMax:y,hasMin:g,totalItems:r.photoset.total,newPages:v}),p.photoPageList={perPage:r.photoset.perPage,page:r.photoset.page,pageContent:v,totalItems:r.photoset.total},p.photoList.length&&(p.primary=r.photoset.primary);var w={id:p.id,countPhotosFamily:r.photoset.countPhotosFamily,countPhotosFriend:r.photoset.countPhotosFriend,countPhotosPublic:r.photoset.countPhotosPublic,countPhotosFriendFamily:r.photoset.countPhotosFriendFamily,totalCount:r.photoset.countPhotosAll};return l.exists(w.id)?l.setValues(n.id,w):l.add(w),o.exists(p.id)?o.setValue(n.id,"photoPageList",p.photoPageList):o.add(p),v}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.photosets.getPhotos",this._processParams(n),!0),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("set-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-curation-models"),r.getModelRegistry("album-privacy-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-photosets-getPhotos"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-models","person-models","set-models","photo-engagement-models","photo-stats-models","photo-curation-models"]});
YUI.add("flickr-photosets-getContext-fetcher",function(e,t){"use strict";function n(t,n){var r={extras:e.APIHelper.request.getRebootPhotoExtras(),photo_id:t.photoId,num_prev:t.numNext,num_next:t.numPrev,get_photoset_info:1};return t.gpCode?(r.share_code=t.gpCode,r.share_owner=t.gpOwner,r.gp_code=t.gpCode,r.gp_owner=t.gpOwner):r.photoset_id=t.id,r}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=[],c=[],h=s.proxy(n.photoId),p,d,v,m,g,y,b=[];return p=r.prevphotos,d=r.nextphotos,c=e.APIHelper.response.parsePhotos({photos:p.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),l=e.APIHelper.response.parsePhotos({photos:d.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}),g=i.getValue(n.id,"photoContextList"),v=g.hasMinBoundary?g.hasMinBoundary():!1,m=g.hasMaxBoundary?g.hasMaxBoundary():!1,y=g.getList(),b=e.APIHelper.response.addOrReplaceListByContext({model:h,next:c,prev:l.reverse(),current:y,hasMin:v,hasMax:m,numNext:n.numNext,numPrev:n.numPrev}),i.setValue(n.id,"photoContextList",b),{next:c,previous:l.reverse()}}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.photosets.getContext",this._processParams(n,r),!0),r.getModelRegistry("set-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-curation-models")]).then(function(e){return i._processResponse(e,n)},function(e){throw e.code===2&&e.message==="Photo not in set"&&(e.notInContext=!0),e}).then(null,e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-photosets-getContext"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["set-models","photo-models","person-models","photo-engagement-models","photo-stats-models","photo-curation-models"]});
YUI.add("flickr-photosets-create-creator",function(e,t){"use strict";function n(n,r){var i={},s=[];return i.title=n.title,i.description=n.description,i.primary_photo_id=n.photoID,i.full_result=1,s=[r.callAPI("flickr.photosets.create",i),r.getModelRegistry("set-models"),r.getModel("person-models",r.getViewer().nsid),r.getModel("sets-models",r.getViewer().nsid),r.getModelRegistry("photo-sets-models"),r.getModelRegistry("photo-contexts-models")],n.isMultiplePhotos||s.push(r.getModel("photo-models",n.photoID)),e.Promise.all(s).then(function(t){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f,l,c,h,p,d=1;return r.photoset.id?(n.isMultiplePhotos?n.numberOfPhotosSelected+n.numberOfVideosSelected===1?(h=r.photoset.photos,p=r.photoset.videos):r.photoset.photos?(h=r.photoset.photos,p=0):(p=r.photoset.videos,h=0):(l=t[6],h=r.photoset.photos,p=r.photoset.videos),f={id:r.photoset.id,title:r.photoset.title.content,photoPageList:n.isMultiplePhotos?[]:[l],photoContextList:n.isMultiplePhotos?[]:[l],owner:s,primary:r.photoset.primary,primaryPhotoSizes:e.APIHelper.response.parsePrimaryPhotoSizes(r.photoset),isAutoUploadSet:!1,photoCount:h,videoCount:p,totalCount:d,viewCount:r.countViews||0},i.add(f),c=i.proxy(r.photoset.id),o.getValue("albumsList").unshift(c),u.exists(n.photoID)&&!u.getValue(n.photoID,"sets").getFromListByID(c.getValue("id"))&&(u.getValue(n.photoID,"sets").prependToList(c),u.setValue(n.photoID,"total",u.getValue(n.photoID,"total")+1)),a.exists(n.photoID)&&!a.getValue(n.photoID,"contexts").getFromListByID(c.getValue("id"))&&(a.setValue(n.photoID,"totalSets",a.getValue(n.photoID,"totalSets")+1),a.getValue(n.photoID,"contexts").appendToList(c)),c):!1},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-photosets-create"]={run:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["set-models","photo-models","person-models","sets-models","photo-sets-models","photo-contexts-models"]});
YUI.add("flickr-photosets-createHidden-creator",function(e,t){"use strict";function n(n,r){var i={},s=[];return i.photo_ids=n.photoIds,s=[r.callAPI("flickr.photosets.createHidden",i),r.getModelRegistry("set-models"),r.getModel("person-models",r.getViewer().nsid)],e.Promise.all(s).then(function(e){var t=e[0],n=e[1],r=e[2],i,s;return t.stat==="ok"&&t.photoset.share_code?(i={id:t.photoset.share_code,shareCode:t.photoset.share_code,owner:r,gpCode:t.photoset.share_code,gpOwner:r.getValue("pathAlias")||r.getValue("nsid"),url:t.photoset.url,isAutoUploadSet:!1,isSharedEntity:!0,totalCount:t.photoset.count},n.add(i),s=n.proxy(i.id),s):!1},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-photosets-createHidden"]={run:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["set-models","photo-models","person-models","sets-models","photo-sets-models","photo-contexts-models"]});
YUI.add("flickr-photosets-editMeta-updater",function(e,t){"use strict";function n(e,t,n){var r=e[0],i=e[1];if(!r.photoset||!r.photoset.title||!r.photoset.description)n.warn("[flickr-photosets-editMeta-updater] - No updated data returned from API.");else{if(!i.exists(t.photosetId))throw new Error("[flickr-photosets-editMeta-updater] - Set model cannot be updated if it does not exist");i.setValues(t.photosetId,{title:r.photoset.title.content,description:r.photoset.description.content})}}function r(n,r){var i={},s=this;return i.photoset_id=n.photosetId,i.title=n.title,i.description=n.description,e.Promise.all([r.callAPI("flickr.photosets.editMeta",i),r.getModelRegistry("set-models")]).then(function(e){s._processResponse(e,n,r)},e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-photosets-editMeta"]={run:r,_processResponse:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-photosets-setPrimaryPhoto-updater",function(e,t){"use strict";function n(n,r){var i={};return i.photoset_id=n.albumId,i.photo_id=n.photoId,r.callAPI("flickr.photosets.setPrimaryPhoto",i).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-photosets-setPrimaryPhoto"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("set-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{langBundles:this.details.langBundles,name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-photosets-getPhotos"].run(t,this.appContext)},create:function(t,n){return e.ModelCreators["flickr-photosets-create"].run(t,n)},createHidden:function(t,n){return e.ModelCreators["flickr-photosets-createHidden"].run(t,n)},addPhoto:function(t,n){return e.ModelCreators["flickr-photosets-addPhoto"].run(t,n)},removePhoto:function(t,n){return e.ModelCreators["flickr-photosets-removePhoto"].run(t,n)},update:function(t,n){return e.ModelUpdaters["flickr-photosets-editMeta"].run({photosetId:t,title:n.title?n.title.newVal:this.getValue(t,"title"),description:n.description?n.description.newVal:this.getValue(t,"description")},this.appContext)},setPrimaryPhoto:function(t,n){return e.ModelUpdaters["flickr-photosets-setPrimaryPhoto"].run(t,n)},"delete":function(t){if(typeof t=="string"){var n=t;t={setID:n}}return e.ModelDeletors["flickr-photosets-delete-deletor"].run(t,this.appContext)}},addPhoto:function(e,t){return this.getValue(e,"photoPageList").hasMaxBoundary()&&this.getValue(e,"photoPageList").appendToList(t),this.getValue(e,"photoContextList").hasMaxBoundary()&&this.getValue(e,"photoContextList").appendToList(t),this},removePhoto:function(e,t){return this.getValue(e,"photoPageList").removeFromList(t.getValue("id")),this.getValue(e,"photoContextList").removeFromList(t.getValue("id")),this},hasPhoto:function(e,t){return this.getValue(e,"photoPageList").getFromListByID(t)||this.getValue(e,"photoContextList").getFromListByID(t)},getSizeToFit:function(t,n,r){e.Flog.warn("Using `getSizeToFit` on `set-models` is deprecated. See model comments for more details.");var i=e.PhotoModelHelper.getSizeToFit(t,n,e.merge({sizes:this.getValue(t,"primaryPhotoSizes"),includeSquare:!0,cropToFit:!0},r));return i&&(i.url=i.src),i},getLargestPrimaryPhotoSize:function(t,n){return e.PhotoModelHelper.getLargestSize(t,n)},attributes:{normalizedId:{readOnly:!0,defaultFn:function(e){return e.split("-")[0]}},displayType:{readOnly:!0,defaultFn:function(){return"set"}},title:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},description:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},owner:{isModel:!0},isOwner:e.PhotoModelHelper.attributes.isOwner,photoPageList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-photosets-getPhotos"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-photosets-getContext"],listItemIdField:"photoId"}},photoCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},videoCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},totalCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return this.getValue(e,"photoCount")+this.getValue(e,"videoCount")}},viewCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},photoCountDisplay:{readOnly:!0,derivedBy:["totalCount"],defaultFn:function(e){var t=this.getValue(e,"photoCount"),n=this.getValue(e,"videoCount"),r=this.getValue(e,"totalCount"),i="";return t-=n,t===0&&n===0?i=this.intlMessage({intlName:"models.ZERO_PHOTOS"}):t===1&&n===0?i=this.intlMessage({intlName:"models.ONE_PHOTO"}):t>1&&n===0?i=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS",photos:t}):t===0&&n===1?i=this.intlMessage({intlName:"models.ONE_VIDEO"}):t===1&&n===1?i=this.intlMessage({intlName:"models.ONE_PHOTO_AND_ONE_VIDEO"}):t>1&&n===1?i=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_ONE_VIDEO",photos:t}):t===0&&n>1?i=this.intlMessage({intlName:"models.MULTIPLE_VIDEOS",videos:n}):t===1&&n>1?i=this.intlMessage({intlName:"models.ONE_PHOTO_AND_MULTIPLE_VIDEOS",videos:n}):t>1&&n>1&&(i=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_MULTIPLE_VIDEOS",photos:t,videos:n})),r===0?i=this.intlMessage({intlName:"models.ZERO_ITEMS"}):r===1?i=this.intlMessage({intlName:"models.ONE_ITEM"}):r>1&&(i=this.intlMessage({intlName:"models.MULTIPLE_ITEMS",items:r})),i}},photoAndVideosDisplay:{readOnly:!0,derivedBy:["photoCount","videoCount"],defaultFn:function(e){var t=this.getValue(e,"photoCount"),n=this.getValue(e,"videoCount"),r="";return t===0&&n===0?r=this.intlMessage({intlName:"models.ZERO_PHOTOS"}):t===1&&n===0?r=this.intlMessage({intlName:"models.ONE_PHOTO"}):t>1&&n===0?r=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS",photos:t}):t===0&&n===1?r=this.intlMessage({intlName:"models.ONE_VIDEO"}):t===1&&n===1?r=this.intlMessage({intlName:"models.ONE_PHOTO_AND_ONE_VIDEO"}):t>1&&n===1?r=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_ONE_VIDEO",photos:t}):t===0&&n>1?r=this.intlMessage({intlName:"models.MULTIPLE_VIDEOS",videos:n}):t===1&&n>1?r=this.intlMessage({intlName:"models.ONE_PHOTO_AND_MULTIPLE_VIDEOS",videos:n}):t>1&&n>1&&(r=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_MULTIPLE_VIDEOS",photos:t,videos:n})),r}},sharedEntityDisplay:{readOnly:!0,derivedBy:["videoCount","photoCount"],defaultFn:function(e){var t=this.getValue(e,"photoCount"),n=this.getValue(e,"videoCount"),r=this.getValue(e,"owner"),i="";return t&&!n?i=this.intlMessage({intlName:"shared-entity.USERNAME_HAS_SHARED_PHOTOS_ONLY",username:r.getValue("displayname"),photoCount:parseInt(t,10)}):!t&&n?i=this.intlMessage({intlName:"shared-entity.USERNAME_HAS_SHARED_VIDEOS_ONLY",username:r.getValue("displayname"),videoCount:parseInt(n,10)}):t&&n&&(i=this.intlMessage({intlName:"shared-entity.USERNAME_HAS_SHARED_PHOTOS_VIDEOS"
,username:r.getValue("displayname"),photoCount:parseInt(t,10),videoCount:parseInt(n,10)})),i}},primary:{},primaryPhotoSizes:{},primaryNeedsInterstitial:{},bestIconURL:{readOnly:!0,derivedBy:["primaryPhotoSizes"],defaultFn:function(t){var n=e.PhotoModelHelper.getSizeToFit(t,{height:48,width:48},e.merge({sizes:this.getValue(t,"primaryPhotoSizes"),includeSquare:!0,cropToFit:!0}));return n?n.src:""}},url:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.getValue(e,"owner"),n=this.getValue(e,"isSharedEntity"),r=this.getValue(e,"normalizedId");return t&&n===!0?"/photos/"+t.getValue("pathAlias")+"/shares/"+r:t?"/photos/"+t.getValue("pathAlias")+"/sets/"+r:undefined}},isAutoUploadSet:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isSharedEntity:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},canShare:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},canDownload:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},urlSuffix:{readOnly:!0,defaultFn:function(e){var t=this.getValue(e,"isSharedEntity");return t?"shares-"+e:"album-"+e}},gpCode:{defaultFn:function(e){return null}},gpOwner:{defaultFn:function(e){return null}}}},{buildCompoundId:function(e,t,n){var r=e;return t&&(r+="-"+t),n&&(t||(r+="-dateposted"),r+="-"+n),r},splitCompoundId:function(e){var t=e.split("-");return{nsid:t[0],orderBy:t[1],viewAs:t[2]}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photosets-addPhoto-creator","flickr-photosets-removePhoto-deletor","flickr-photosets-delete-deletor","flickr-photosets-getPhotos-fetcher","flickr-photosets-getContext-fetcher","flickr-photosets-create-creator","flickr-photosets-createHidden-creator","flickr-photosets-editMeta-updater","flickr-photosets-setPrimaryPhoto-updater","photo-model-helper"],langBundles:["models","shared-entity"]});
YUI.add("confirmation-dialog-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.set("title",e.title?e.title:this.intlMessage({intlName:"common.CONFIRM"})),this.set("icon",e.icon?e.icon:!1),this.set("content",e.content?e.content:"A blurb about what this will do"),this.set("confirmButtonLabel",e.confirmButtonLabel?e.confirmButtonLabel:this.intlMessage({intlName:"common.OK"})),this.set("cancelButtonLabel",e.cancelButtonLabel?e.cancelButtonLabel:this.intlMessage({intlName:"common.CANCEL"})),this.set("auxiliaryButtonLabel",e.auxiliaryButtonLabel?e.auxiliaryButtonLabel:this.intlMessage({intlName:"common.CANCEL"})),this.set("confirmButtonClass",e.confirmButtonClass?e.confirmButtonClass:""),this.set("cancelButtonClass",e.cancelButtonClass?e.cancelButtonClass:""),this.set("auxiliaryButtonClass",e.auxiliaryButtonClass?e.auxiliaryClass:""),this.set("showConfirmButton",typeof e.showConfirmButton=="undefined"?!0:e.showConfirmButton),this.set("showCancelButton",typeof e.showCancelButton=="undefined"?!1:e.showCancelButton),this.set("showAuxiliaryButton",typeof e.showAuxiliaryButton=="undefined"?!1:e.showAuxiliaryButton),this.set("deletePhotoConfirmation",e.deletePhotoConfirmation?e.deletePhotoConfirmation:!1),this.set("imgSrc",e.imgSrc?e.imgSrc:""),this.set("organizrLink",e.organizrLink?e.organizrLink:!1),this.set("dialog",e.dialog),this},render:function(){return this.setContainerHTML(this.templates("confirmation-dialog")({title:this.get("title"),icon:this.get("icon"),heading:this.get("heading"),content:this.get("content"),confirmButtonLabel:this.get("confirmButtonLabel"),cancelButtonLabel:this.get("cancelButtonLabel"),auxiliaryButtonLabel:this.get("auxiliaryButtonLabel"),confirmButtonClass:this.get("confirmButtonClass"),cancelButtonClass:this.get("cancelButtonClass"),auxiliaryButtonClass:this.get("auxiliaryButtonClass"),deletePhotoConfirmation:this.get("deletePhotoConfirmation"),imgSrc:this.get("imgSrc"),organizrLink:this.get("organizrLink"),showConfirmButton:this.get("showConfirmButton"),showCancelButton:this.get("showCancelButton"),showAuxiliaryButton:this.get("showAuxiliaryButton")})),this},handleCancelClick:function(t){e.Views.dialog.close()},handleAuxiliaryClick:function(e){this.fire("auxiliaryClick")},activate:function(){var e=this,t=this.get("container").one(".ui-dialog-button-close");return this.get("showCancelButton")&&(this.get("container").one(".cancel-confirmation").on("click",function(t){e.handleCancelClick(t)}),this.get("container").one(".ui-dialog-button-cancel").on("click",function(t){e.handleCancelClick(t)})),this.get("showAuxiliaryButton")&&this.get("container").one(".auxiliary-confirmation").on("click",function(t){e.handleAuxiliaryClick(t)}),t&&t.on("click",function(t){e.handleCancelClick(t)}),this}})},"@VERSION@",{requires:["flickr-view","dialog","confirmation-dialog-css","hermes-template-confirmation-dialog"],optional:["set-models"],langBundles:["common","photo-page-scrappy"]});
YUI.add("hermes-template-comment",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function d(e,t){var n="",r;return n+='\n			<img src="'+l((r=(r=(r=e.author,r==null||r===!1?r:r.buddyicon),r==null||r===!1?r:r["default"]),typeof r===f?r.apply(e):r))+'" width="25" height="25">\n		',n}function v(e,t){var n="",r;return n+='\n			<img src="'+l((r=(r=e.author,r==null||r===!1?r:r.buddyicon),typeof r===f?r.apply(e):r))+'" width="25" height="25">\n		',n}function m(e,t){var r="",i;r+="\n				",i=n["if"].call(e,e.commentBelongsToViewer,{hash:{},inverse:c.program(12,E,t),fn:c.program(6,g,t),data:t});if(i||i===0)r+=i;r+="\n				",i=n["if"].call(e,e.canCommentBeDeleted,{hash:{},inverse:c.noop,fn:c.program(20,C,t),data:t});if(i||i===0)r+=i;return r+='\n				<a href="',(i=n.permalink)?i=i.call(e,{hash:{},data:t}):(i=e.permalink,i=typeof i===f?i.apply(e):i),r+=l(i)+'" class="comment-permalink ui-icon-comment-permalink" data-track="commentPermalinkClick" data-action="follow"></a>\n			',r}function g(e,t){var r="",i;r+="\n					",i=n["if"].call(e,e.noIcons,{hash:{},inverse:c.program(9,b,t),fn:c.program(7,y,t),data:t});if(i||i===0)r+=i;return r+="\n				",r}function y(e,t){return"\n					"}function b(e,t){var r="",i;r+="\n						",i=n["if"].call(e,e.enabledEditableComments,{hash:{},inverse:c.noop,fn:c.program(10,w,t),data:t});if(i||i===0)r+=i;return r+="\n					",r}function w(e,t){var r="",i;return r+='\n							<a href="#" class="comment-edit ui-icon-comment-edit" data-id="',(i=n.id)?i=i.call(e,{hash:{},data:t}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-action="edit" title="Edit"></a>\n						',r}function E(e,t){var r="",i;r+="\n					",i=n["if"].call(e,e.canComment,{hash:{},inverse:c.noop,fn:c.program(13,S,t),data:t});if(i||i===0)r+=i;return r+="\n				",r}function S(e,t){var r="",i,s,o;r+='\n						<a href="#" class="comment-reply ',i=n["if"].call(e,e.noIcons,{hash:{},inverse:c.program(16,T,t),fn:c.program(14,x,t),data:t});if(i||i===0)r+=i;r+='" data-pathalias="'+l((i=(i=e.author,i==null||i===!1?i:i.pathAlias),typeof i===f?i.apply(e):i))+'" data-action="reply" title="Reply">',o={hash:{},inverse:c.noop,fn:c.program(18,N,t),data:t},(s=n.noIcons)?s=s.call(e,o):(s=e.noIcons,s=typeof s===f?s.apply(e):s),n.noIcons||(s=h.call(e,s,o));if(s||s===0)r+=s;return r+="</a>\n					",r}function x(e,t){var n="";return n}function T(e,t){return"ui-icon-comment-reply"}function N(e,t){return"Reply"}function C(e,t){var r="",i;return r+='\n					<a href="#" class="comment-delete ui-icon-comment-delete" data-id="',(i=n.id)?i=i.call(e,{hash:{},data:t}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-action="delete" title="Delete"></a>\n				',r}function k(e,t){var r,i;return i={hash:{intlName:e.intlName,time:e.time},data:t},l((r=n.intlMessage||e.intlMessage,r?r.call(e,i):p.call(e,"intlMessage",i)))}function L(e,t){var r="",i,s;return r+='\n        <div class="comment-content">',s={hash:{},data:t},r+=l((i=n.renderSafeInlineComment||e.renderSafeInlineComment,i?i.call(e,e.contentSecure,e.ellipsis,s):p.call(e,"renderSafeInlineComment",e.contentSecure,e.ellipsis,s)))+"</div>\n	",r}function A(e,t){var r="",i,s;return r+='\n        <div class="comment-content">',s={hash:{},data:t},r+=l((i=n.renderTrustedMarkupWithLineBreaks||e.renderTrustedMarkupWithLineBreaks,i?i.call(e,e.contentSecure,s):p.call(e,"renderTrustedMarkupWithLineBreaks",e.contentSecure,s)))+"</div>\n	",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.blockHelperMissing,p=n.helperMissing;s+='<li class="comment" id="',a={hash:{},data:i},s+=l((o=n.commentPermalinkId||t.commentPermalinkId,o?o.call(t,t.id,a):p.call(t,"commentPermalinkId",t.id,a)))+'">\n	<div class="comment-icon circle-icon">\n		<a data-person-nsid="'+l((o=(o=t.author,o==null||o===!1?o:o.nsid),typeof o===f?o.apply(t):o))+'" href="/photos/'+l((o=(o=t.author,o==null||o===!1?o:o.pathAlias),typeof o===f?o.apply(t):o))+'/" data-track="commentBuddyIconClick" data-action="follow">\n		',u=n["if"].call(t,(o=(o=t.author,o==null||o===!1?o:o.buddyicon),o==null||o===!1?o:o["default"]),{hash:{},inverse:c.program(3,v,i),fn:c.program(1,d,i),data:i});if(u||u===0)s+=u;s+='\n		</a>\n	</div>\n	<p class="comment-author">\n		<a href="/photos/'+l((o=(o=t.author,o==null||o===!1?o:o.pathAlias),typeof o===f?o.apply(t):o))+'/" data-track="commentUserNameClick" data-action="follow">\n			',a={hash:{},data:i},s+=l((o=n.truncate||t.truncate,o?o.call(t,(o=t.author,o==null||o===!1?o:o.displayname),20,a):p.call(t,"truncate",(o=t.author,o==null||o===!1?o:o.displayname),20,a)))+'\n		</a>\n		<span class="comment-actions">\n			',u=n["if"].call(t,t.isSignedIn,{hash:{},inverse:c.noop,fn:c.program(5,m,i),data:i});if(u||u===0)s+=u;s+='\n		</span>\n	</p>\n	<div class="comment-date">',a={hash:{},inverse:c.noop,fn:c.program(22,k,i),data:i},u=(o=n.friendlySinceDate||t.friendlySinceDate,o?o.call(t,t.timeago,!0,!1,a):p.call(t,"friendlySinceDate",t.timeago,!0,!1,a));if(u||u===0)s+=u;s+="</div>\n	",u=n["if"].call(t,t.isTooltipComment,{hash:{},inverse:c.program(26,A,i),fn:c.program(24,L,i),data:i});if(u||u===0)s+=u;return s+="\n</li>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/comment",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-comments",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function u(e,t){var r="",i;r+="\n	<ul class='comments'>\n		",i=n.each.call(e,e.comments,{hash:{},inverse:o.noop,fn:o.program(2,a,t),data:t});if(i||i===0)r+=i;return r+="\n	</ul>\n",r}function a(e,t){var i="",s;i+="\n			",s=o.invokePartial(r.comment,"comment",e,n,r,t);if(s||s===0)i+=s;return i+="\n		",i}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=this.merge(r,e.partials),i=i||{};var s,o=this;return s=n["if"].call(t,t.comments,{hash:{},inverse:o.noop,fn:o.program(1,u,i),data:i}),s||s===0?s:""}),r={};e.Array.each(["comment"],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/comments",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-comment"]});
YUI.add("hermes-template-sub-photo-comment",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function d(e,t){return" no-menu "}function v(e,t){var n="",r;return n+='\n			<img src="'+l((r=(r=(r=e.author,r==null||r===!1?r:r.buddyicon),r==null||r===!1?r:r["default"]),typeof r===f?r.apply(e):r))+'" width="32" height="32">\n		',n}function m(e,t){var n="",r;return n+='\n			<img src="'+l((r=(r=e.author,r==null||r===!1?r:r.buddyicon),typeof r===f?r.apply(e):r))+'" width="32" height="32">\n		',n}function g(e,t){var r="",i,s;r+="\n			",s=n["if"].call(e,(i=e.author,i==null||i===!1?i:i.isPro),{hash:{},inverse:c.noop,fn:c.program(8,y,t),data:t});if(s||s===0)r+=s;return r+="\n		",r}function y(e,t){return'\n				<span class="pro-badge-inline">PRO</span>\n			'}function b(e,t){var r,i;return i={hash:{intlName:e.intlName,time:e.time},data:t},l((r=n.intlMessage||e.intlMessage,r?r.call(e,i):h.call(e,"intlMessage",i)))}function w(e,t){var r="",i,s;r+="\n				",i=n["if"].call(e,e.commentBelongsToViewer,{hash:{},inverse:c.program(22,k,t),fn:c.program(13,E,t),data:t});if(i||i===0)r+=i;r+="\n				",i=n["if"].call(e,e.canCommentBeDeleted,{hash:{},inverse:c.noop,fn:c.program(30,_,t),data:t});if(i||i===0)r+=i;return r+='\n				<a href="',(i=n.permalink)?i=i.call(e,{hash:{},data:t}):(i=e.permalink,i=typeof i===f?i.apply(e):i),r+=l(i)+'" class="comment-permalink ui-icon-comment-permalink" data-track="commentPermalinkClick" title="',s={hash:{intlName:"photo-page-scrappy.PERMALINK"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+'"></a>\n			',r}function E(e,t){var r="",i;r+="\n					",i=n["if"].call(e,e.noIcons,{hash:{},inverse:c.program(16,x,t),fn:c.program(14,S,t),data:t});if(i||i===0)r+=i;return r+="\n				",r}function S(e,t){return"\n					"}function x(e,t){var r="",i;r+="\n						",i=n["if"].call(e,e.enabledEditableComments,{hash:{},inverse:c.noop,fn:c.program(17,T,t),data:t});if(i||i===0)r+=i;return r+="\n					",r}function T(e,t){var r="",i;r+="\n							",i=n["if"].call(e,e.isOnMobile,{hash:{},inverse:c.program(20,C,t),fn:c.program(18,N,t),data:t});if(i||i===0)r+=i;return r+="\n						",r}function N(e,t){var r="",i,s,o;return r+='\n								<a href="#" class="comment-edit" data-id="',(i=n.id)?i=i.call(e,{hash:{},data:t}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-action="edit" title="',o={hash:{intlName:"common.EDIT"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,o):h.call(e,"intlMessage",o)))+'">\n									<svg class="icon icon-edit"  data-id="',(s=n.id)?s=s.call(e,{hash:{},data:t}):(s=e.id,s=typeof s===f?s.apply(e):s),r+=l(s)+'" data-action="edit"><use xlink:href="#icon-edit" data-id="',(s=n.id)?s=s.call(e,{hash:{},data:t}):(s=e.id,s=typeof s===f?s.apply(e):s),r+=l(s)+'" data-action="edit"></use></svg>\n								</a>\n							',r}function C(e,t){var r="",i,s;return r+='\n								<a href="#" class="comment-edit ui-icon-comment-edit" data-id="',(i=n.id)?i=i.call(e,{hash:{},data:t}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-action="edit" title="',s={hash:{intlName:"common.EDIT"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+'"></a>\n							',r}function k(e,t){var r="",i;r+="\n					",i=n["if"].call(e,e.canComment,{hash:{},inverse:c.noop,fn:c.program(23,L,t),data:t});if(i||i===0)r+=i;return r+="\n				",r}function L(e,t){var r="",i,s,o;r+='\n						<a href="#" class="comment-reply ',i=n["if"].call(e,e.noIcons,{hash:{},inverse:c.program(26,O,t),fn:c.program(24,A,t),data:t});if(i||i===0)r+=i;r+='" data-pathalias="'+l((i=(i=e.author,i==null||i===!1?i:i.pathAlias),typeof i===f?i.apply(e):i))+'" data-action="reply" title="',o={hash:{intlName:"photo-page-scrappy.REPLY"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,o):h.call(e,"intlMessage",o)))+'">',o={hash:{},inverse:c.noop,fn:c.program(28,M,t),data:t},(s=n.noIcons)?s=s.call(e,o):(s=e.noIcons,s=typeof s===f?s.apply(e):s),n.noIcons||(s=p.call(e,s,o));if(s||s===0)r+=s;return r+="</a>\n					",r}function A(e,t){var n="";return n}function O(e,t){return"ui-icon-comment-reply"}function M(e,t){return"Reply"}function _(e,t){var r="",i;r+="\n					",i=n["if"].call(e,e.isOnMobile,{hash:{},inverse:c.program(33,P,t),fn:c.program(31,D,t),data:t});if(i||i===0)r+=i;return r+="\n				",r}function D(e,t){var n="";return n+="\n						\n					",n}function P(e,t){var r="",i,s;return r+='\n						<a href="#" class="comment-delete ui-icon-comment-delete" data-id="',(i=n.id)?i=i.call(e,{hash:{},data:t}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-action="delete" title="',s={hash:{intlName:"common.DELETE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+'"></a>\n					',r}function H(e,t){var r="",i,s;return r+='\n        <div class="comment-content">',s={hash:{},data:t},r+=l((i=n.renderSafeInlineComment||e.renderSafeInlineComment,i?i.call(e,e.contentSecure,e.ellipsis,s):h.call(e,"renderSafeInlineComment",e.contentSecure,e.ellipsis,s)))+"</div>\n	",r}function B(e,t){var r="",i,s;return r+='\n        <div class="comment-content">',s={hash:{},data:t},r+=l((i=n.renderTrustedMarkupWithLineBreaks||e.renderTrustedMarkupWithLineBreaks,i?i.call(e,e.contentSecure,s):h.call(e,"renderTrustedMarkupWithLineBreaks",e.contentSecure,s)))+"</div>\n	",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing,p=n.blockHelperMissing;s+='<li class="comment" id="',a={hash:{},data:i},s+=l((o=n.commentPermalinkId||t.commentPermalinkId,o?o.call(t,t.id,a):h.call(t,"commentPermalinkId",t.id,a)))+'">\n	<div class="comment-icon circle-icon ',u=n["if"].call(t,t.isOnMobile,{hash:{},inverse:c.noop,fn:c.program(1,d,i),data:i});if(u||u===0)s+=u;s+='">\n		<a data-person-nsid="'+l((o=(o=t.author,o==null||o===!1?o:o.nsid),typeof o===f?o.apply(t):o))+'" href="/photos/'+l((o=(o=t.author,o==null||o===!1?o:o.pathAlias),typeof o===f?o.apply(t):o))+'/" data-track="commentBuddyIconClick" data-action="follow">\n\n		'
,u=n["if"].call(t,(o=(o=t.author,o==null||o===!1?o:o.buddyicon),o==null||o===!1?o:o["default"]),{hash:{},inverse:c.program(5,m,i),fn:c.program(3,v,i),data:i});if(u||u===0)s+=u;s+='\n		</a>\n	</div>\n\n	<p class="comment-author">\n\n		<a href="/photos/'+l((o=(o=t.author,o==null||o===!1?o:o.pathAlias),typeof o===f?o.apply(t):o))+'/" data-track="commentUserNameClick" data-action="follow">'+l((o=(o=t.author,o==null||o===!1?o:o.displayname),typeof o===f?o.apply(t):o))+"</a>\n\n		",u=n["if"].call(t,t.enabledNewPro,{hash:{},inverse:c.noop,fn:c.program(7,g,i),data:i});if(u||u===0)s+=u;s+='\n\n		<span class="comment-date">',a={hash:{},inverse:c.noop,fn:c.program(10,b,i),data:i},u=(o=n.friendlySinceDate||t.friendlySinceDate,o?o.call(t,t.timeago,!0,!1,a):h.call(t,"friendlySinceDate",t.timeago,!0,!1,a));if(u||u===0)s+=u;s+='</span>\n\n		<span class="comment-actions">\n			',u=n["if"].call(t,t.isSignedIn,{hash:{},inverse:c.noop,fn:c.program(12,w,i),data:i});if(u||u===0)s+=u;s+="\n		</span>\n	</p>\n	",u=n["if"].call(t,t.isTooltipComment,{hash:{},inverse:c.program(37,B,i),fn:c.program(35,H,i),data:i});if(u||u===0)s+=u;return s+="\n</li>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/sub-photo-comment",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-sub-photo-comments",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function a(e,t){return'<a href="#" name="comments"></a>'}function f(e,t){var r="",i;r+="\n	<ul class='comments'>\n		",i=n.each.call(e,e.comments,{hash:{},inverse:u.noop,fn:u.program(4,l,t),data:t});if(i||i===0)r+=i;return r+="\n	</ul>\n",r}function l(e,t){var i="",s;i+="\n			",s=u.invokePartial(r["sub-photo-comment"],"sub-photo-comment",e,n,r,t);if(s||s===0)i+=s;return i+="\n		",i}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=this.merge(r,e.partials),i=i||{};var s="",o,u=this;o=n["if"].call(t,t.isOnMobile,{hash:{},inverse:u.noop,fn:u.program(1,a,i),data:i});if(o||o===0)s+=o;s+="\n\n",o=n["if"].call(t,t.comments,{hash:{},inverse:u.noop,fn:u.program(3,f,i),data:i});if(o||o===0)s+=o;return s}),r={};e.Array.each(["sub-photo-comment"],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/sub-photo-comments",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-sub-photo-comment"]});
YUI.add("hermes-template-sub-photo-comment-form",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){var r="",i,s,o;r+='\n		<div class="comment-icon circle-icon">\n			',s=n["if"].call(e,(i=(i=e.user,i==null||i===!1?i:i.buddyicon),i==null||i===!1?i:i.medium),{hash:{},inverse:f.program(4,p,t),fn:f.program(2,h,t),data:t});if(s||s===0)r+=s;return r+='\n		</div>\n		<div class="comment-form-field">\n			<textarea class="new-comment-text" name="comment" placeholder="',o={hash:{intlName:"photo-page-scrappy.ADD_A_COMMENT"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'" data-notutorial="',o={hash:{intlName:"photo-page-scrappy.ADD_A_COMMENT"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'" data-tutorial="',o={hash:{intlName:"photo-page-scrappy.COMMENT_TUTORIAL"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,o):l.call(e,"intlMessage",o)))+'" data-action="comment"></textarea>\n			<div class="comment-arrow"></div>\n			<textarea class="false-comment-content"></textarea>\n		</div>\n	',r}function h(e,t){var n="",r;return n+='\n				<img src="'+a((r=(r=(r=e.user,r==null||r===!1?r:r.buddyicon),r==null||r===!1?r:r.medium),typeof r===u?r.apply(e):r))+'" width="32" height="32" />\n			',n}function p(e,t){var n="",r;return n+='\n				<img src="'+a((r=(r=(r=e.user,r==null||r===!1?r:r.buddyicon),r==null||r===!1?r:r["default"]),typeof r===u?r.apply(e):r))+'" width="32" height="32" />\n			',n}function d(e,t){var r="",i,s;return r+='\n		<div class="comment-form-field is-logged-out">\n			<a href="#"></a>\n			<textarea name="comment" disabled placeholder="',s={hash:{intlName:"photo-page-scrappy.SIGNED_IN_TO_POST_A_COMMENT"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'" data-action="comment"></textarea>\n		</div>\n	',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this,l=n.helperMissing;s+='<div class="comments-form">\n	',o=n["if"].call(t,t.user,{hash:{},inverse:f.program(6,d,i),fn:f.program(1,c,i),data:i});if(o||o===0)s+=o;return s+="\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/sub-photo-comment-form",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
