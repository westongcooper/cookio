YUI.add("tag-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{create:function(t){return e.ModelCreators["flickr-photos-addTags"].run(t,this.appContext)},"delete":function(t){return e.ModelDeletors["flickr-photos-removeTag"].run(t,this.appContext)}},attributes:{tagValue:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t.trim().replace(/\s/g,""))}},tagRaw:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},tagAuthorNSID:{},isMachineTag:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},url:{derivedBy:["tagValue"],readOnly:!0,defaultFn:function(e){var t=this.getValue(e,"tagValue");return t?"/photos/tags/"+t:undefined}},searchUrl:{derivedBy:["tagValue","tagRaw","isMachineTag"],readOnly:!0,defaultFn:function(e){var t=this.getValue(e,"tagRaw"),n=this.getValue(e,"tagValue"),r=this.getValue(e,"isMachineTag"),i;return t&&r?(t.indexOf(" ")>0&&(i=t.indexOf("=")+1,t=t.substring(0,i)+'"'+t.substring(i)+'"'),"/search/?tags="+t):n?"/search/?tags="+n:undefined}},duplicateAutotagId:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-addTags-creator","flickr-photos-removeTag-deletor"]});
YUI.add("flickr-tags-getListPhoto-fetcher",function(e,t){"use strict";function n(t,n,r){var i=t[0],s=t[1],o=t[2],u=i.photo&&i.photo.tags&&typeof i.photo.tags.tag!="undefined"?i.photo.tags.tag.length:0,a=[],f=t[3],l=t[4],c=0,h=[],p;return u>0&&e.Array.each(i.photo.tags.tag,function(e){typeof e.content=="string"&&a.push(o.addOrUpdate({id:e.id,tagRaw:e.raw,tagValue:e.content,tagAuthorNSID:e.author,isMachineTag:e.machineTag,duplicateAutotagId:e.duplicateAutotag}))}),s.exists(n)?s.setValue(n,"tags",a):s.add({id:n,tags:a}),p={id:n},i.photo&&i.photo.autotags&&typeof i.photo.autotags.autotag!="undefined"&&(c=i.photo.autotags.autotag.length),c>0&&e.Array.each(i.photo.autotags.autotag,function(e){typeof e.content=="string"&&h.push(l.addOrUpdate({id:e.id,autotagValue:e.content,score:e.confidence,isPrivate:e.private}))}),p.autotags={page:1,perPage:1e3,pageContent:h,totalItems:c},f.exists(n)?f.setValue(n,"autotags",p.autotags):f.add(p),s.proxy(n)}function r(n,r){var i=n.id,s={photo_id:i,extras:"autotags",lang:r.lang},o=this;return e.Promise.all([r.callAPI("flickr.tags.getListPhoto",s),r.getModelRegistry("photo-tags-models"),r.getModelRegistry("tag-models"),r.getModelRegistry("photo-autotags-models"),r.getModelRegistry("autotag-models")]).then(function(e){return o._processResponse(e,i,r.flipper)},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-tags-getListPhoto"]={run:r,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["tag-models","photo-tags-models"]});
YUI.add("photo-tags-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-tags-getListPhoto"].run(t,this.appContext)},create:function(t){return e.ModelCreators["flickr-photos-addTags"].run(t,this.appContext)},"delete":function(t){return e.ModelDeletors["flickr-photos-removeTag"].run(t,this.appContext)}},attributes:{tags:{isCollection:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-tags-getListPhoto-fetcher","flickr-photos-addTags-creator","flickr-photos-removeTag-deletor"]});
YUI.add("sub-photo-title-desc-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.photoId=e.photoId,this.full=e.full||!1,this.isMobile=e.isMobile||!1,this},loadState:function(){var t=this,n=[],r={photo:t.appContext.getModel("photo-models",t.photoId)};return n.push((new e.FlickrPromise(r)).then(function(e){t.set("photo",e.photo)})),e.Promise.all(n)},buildContainer:function(){var e=this.get("photo"),t=e.getValue("title"),n=e.getValue("description"),r={title:!1,desc:!1},i=!1,s=!1,o=!1,u=e.getValue("isOwner"),a,f;if(t.trim()===""||t.toUpperCase()==="<BR>")r.title=!0;return r.title&&u&&(t=this.intlMessage({intlName:"photo-page-scrappy.ADD_TITLE"})),t=this.removeLinkFromHash(t),n.trim()===""&&(r.desc=!0),r.desc&&u&&(n=this.intlMessage({intlName:"photo-page-scrappy.ADD_DESCRIPTION"})),r.desc&&r.title&&!u?i=!0:r.desc&&!u?o=!0:r.title&&!u&&(s=!0),a={title:t,description:n,empty:r,isMobile:this.isMobile,isOwner:u,noContentToDisplay:i,noTitleToDisplay:s,noDescToDisplay:o},f=this.templates("sub-photo-title-desc")(a),this.setContainerHTML(f),this},fixEmoji:function(){if(!e.UA.chrome)return;var t=/\uD83C(?:\uDDE6\uD83C(?:\uDDEB|\uDDFD|\uDDF1|\uDDF8|\uDDE9|\uDDF4|\uDDEE|\uDDF6|\uDDEC|\uDDF7|\uDDF2|\uDDFC|\uDDE8|\uDDFA|\uDDF9|\uDDFF|\uDDEA)|\uDDE9\uD83C(?:\uDDFF|\uDDF0|\uDDEC|\uDDEF|\uDDF2|\uDDF4|\uDDEA)|\uDDE7\uD83C(?:\uDDF8|\uDDED|\uDDE9|\uDDE7|\uDDFE|\uDDEA|\uDDFF|\uDDEF|\uDDF2|\uDDF9|\uDDF4|\uDDE6|\uDDFC|\uDDFB|\uDDF7|\uDDF3|\uDDEC|\uDDEB|\uDDEE|\uDDF6|\uDDF1)|\uDDEE\uD83C(?:\uDDF4|\uDDE8|\uDDF8|\uDDF3|\uDDE9|\uDDF7|\uDDF6|\uDDEA|\uDDF2|\uDDF1|\uDDF9)|\uDDFB\uD83C(?:\uDDEC|\uDDE8|\uDDEE|\uDDFA|\uDDE6|\uDDEA|\uDDF3)|\uDDF0\uD83C(?:\uDDED|\uDDFE|\uDDF2|\uDDFF|\uDDEA|\uDDEE|\uDDFC|\uDDEC|\uDDF5|\uDDF7|\uDDF3)|\uDDE8\uD83C(?:\uDDF2|\uDDE6|\uDDFB|\uDDEB|\uDDF1|\uDDF3|\uDDFD|\uDDF5|\uDDE8|\uDDF4|\uDDEC|\uDDE9|\uDDF0|\uDDF7|\uDDEE|\uDDFA|\uDDFC|\uDDFE|\uDDFF|\uDDED)|\uDDEA\uD83C(?:\uDDE6|\uDDE8|\uDDEC|\uDDF7|\uDDEA|\uDDF9|\uDDFA|\uDDF8|\uDDED)|\uDDF9\uD83C(?:\uDDE9|\uDDEB|\uDDFC|\uDDEF|\uDDFF|\uDDED|\uDDF1|\uDDEC|\uDDF0|\uDDF4|\uDDF9|\uDDE6|\uDDF3|\uDDF7|\uDDF2|\uDDE8|\uDDFB)|\uDDED\uD83C(?:\uDDF7|\uDDF9|\uDDF2|\uDDF3|\uDDF0|\uDDFA)|\uDDF8\uD83C(?:\uDDFB|\uDDF2|\uDDF9|\uDDE6|\uDDF3|\uDDE8|\uDDF1|\uDDEC|\uDDFD|\uDDF0|\uDDEE|\uDDE7|\uDDF4|\uDDF8|\uDDED|\uDDE9|\uDDF7|\uDDEF|\uDDFF|\uDDEA|\uDDFE)|\uDDEC\uD83C(?:\uDDF6|\uDDEB|\uDDE6|\uDDF2|\uDDEA|\uDDED|\uDDEE|\uDDF7|\uDDF1|\uDDE9|\uDDF5|\uDDFA|\uDDF9|\uDDEC|\uDDF3|\uDDFC|\uDDFE|\uDDF8|\uDDE7)|\uDDEB\uD83C(?:\uDDF0|\uDDF4|\uDDEF|\uDDEE|\uDDF7|\uDDF2)|\uDDF5\uD83C(?:\uDDEB|\uDDF0|\uDDFC|\uDDF8|\uDDE6|\uDDEC|\uDDFE|\uDDEA|\uDDED|\uDDF3|\uDDF1|\uDDF9|\uDDF7|\uDDF2)|\uDDEF\uD83C(?:\uDDF2|\uDDF5|\uDDEA|\uDDF4)|\uDDFD\uD83C\uDDF0|\uDDF1\uD83C(?:\uDDE6|\uDDFB|\uDDE7|\uDDF8|\uDDF7|\uDDFE|\uDDEE|\uDDF9|\uDDFA|\uDDF0|\uDDE8)|\uDDF2\uD83C(?:\uDDF4|\uDDF0|\uDDEC|\uDDFC|\uDDFE|\uDDFB|\uDDF1|\uDDF9|\uDDED|\uDDF6|\uDDF7|\uDDFA|\uDDFD|\uDDE9|\uDDE8|\uDDF3|\uDDEA|\uDDF8|\uDDE6|\uDDFF|\uDDF2|\uDDF5|\uDDEB)|\uDDFE\uD83C(?:\uDDF9|\uDDEA)|\uDDF3\uD83C(?:\uDDE6|\uDDF7|\uDDF5|\uDDF1|\uDDE8|\uDDFF|\uDDEE|\uDDEA|\uDDEC|\uDDFA|\uDDEB|\uDDF4)|\uDDF4\uD83C\uDDF2|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C(?:\uDDEA|\uDDF4|\uDDFA|\uDDFC|\uDDF8)|\uDDFC\uD83C(?:\uDDF8|\uDDEB)|\uDDFF\uD83C(?:\uDDE6|\uDDF2|\uDDFC)|\uDDFA\uD83C(?:\uDDEC|\uDDE6|\uDDF8|\uDDFE|\uDDF2|\uDDFF))|[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD95\uDD96\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0\uDEEB\uDEEC]|\uD83E[\uDD10-\uDD18\uDD80-\uDD84\uDDC0]/g,n=this.get("container"),r=n.one(".photo-title"),i=n.one(".edit-photo-title"),s,o,u="fix-emoji";r&&(s=r.getHTML(),t.test(s)?(o=!0,r.addClass(u)):r.removeClass(u)),i&&(s=i.get("value"),o||t.test(s)?i.addClass(u):i.removeClass(u))},showFull:function(e){this.full?e.target.getDOMNode().tagName.toUpperCase()!=="A"&&(e.preventDefault(),this.toggleTitleDesc({show:!1,showButton:!0})):this.toggleTitleDesc({show:!1,showButton:!0})},addLinkToHash:function(e){var t=/\s#[^#\s]+/gi,n;return n=e.replace(t,function(t,n,r){return n>0&&e.slice(n-1,1)==="&"?t:' <a href="/photos/tags/'+t.slice(2)+'">'+t.slice(1)+"</a>"}),n},removeLinkFromHash:function(e){var t=/<[^>]*>(.*?\s#[^#\s]+?.*?)<[\s]*\/[\s]*[^>]*>/gi,n;return n=e.replace(t,function(e,t,n){return t}),n},filterDuplicateTags:function(e,t){var n=/#[^#\s]+/gi,r,i=[];return t&&e&&(r=(e.match(n)||[]).map(function(e){return e.slice(1)}),i=t.filter(function(e){return r.indexOf(e.tagValue)===-1})),i},wrapDescription:function(e){var t=e.split("\n"),n=this;return t.length===1&&t[0]===""?"":t.map(function(e){return"<p>"+n.addLinkToHash(n.removeLinkFromHash(e))+"</p>\n"}).join("")},unwrapDescription:function(e){var t=e.split("</p>");return t.map(function(e){return e.replace(/(<p) {1,1}([\s]+id="yui_[\d_]+"[.]*) {0,1}>/g,"")}).filter(function(e){return e.trim()!==""}).join("").replace(/^(\n)+(.*)/g,"$2")},doneEditingAttr:function(t){var n=this.get("container"),r=this,i=this.get("photo"),s=n.one(".photo-title"),o=n.one(".photo-desc"),u=n.one(".edit-photo-title"),a=n.one(".edit-photo-desc"),f,l=u.get("value"),c=a.get("value"),h,p=i.getValue("title"),d=i.getValue("description"),v;n.removeClass("editing"),e.one("body").one(".editing-shim")&&e.one("body").all(".editing-shim").remove(),n.one(".done-editing-title-desc").setStyle("display","none"),s.set("text",l),o.set("text",c),s.set("contenteditable",null),o.set("contenteditable",null),s.addClass("disabled"),o.addClass("disabled"
),v=c.toString(),v=v.replace(/(#[^#\s]+)/gi,function(e,t,n,r){return n>0&&v.slice(n-1,n)==="&"?"":e}),h=(v.match(/(#[^#\s]+)/gi)||[]).map(function(e){return e.slice(1)}),i.setValue("title",l),i.setValue("description",c),h.length>0&&this.appContext.getModelRegistry("photo-tags-models").then(function(t){var n=[];return h.length>0&&n.push(t.remoteCreate({photoId:[r.photoId],tags:h.join(",")})),e.Promise.all(n)}).then(function(t){t[0].length>0&&e.fire("flickr:photo-page--new-tags-added",t[0])},function(e){}),l===""||l.toUpperCase()==="<BR>"?(s.setHTML(this.intlMessage({intlName:"photo-page-scrappy.ADD_TITLE"})),s.addClass("placeholder-text")):s.removeClass("placeholder-text"),c===""||c.toUpperCase()==="<BR>"?(o.setHTML(this.intlMessage({intlName:"photo-page-scrappy.ADD_DESCRIPTION"})),o.addClass("placeholder-text")):o.removeClass("placeholder-text"),s.removeClass("show-editable"),u.removeClass("show-editable"),o.removeClass("show-editable"),a.removeClass("show-editable"),r.fixEmoji(),f=i.remoteUpdate(),f.then(function(){var t=i.getValue("title"),n=i.getValue("description");s.set("contenteditable","true"),o.set("contenteditable","true"),s.removeClass("disabled"),o.removeClass("disabled"),t===""?(s.setHTML(r.intlMessage({intlName:"photo-page-scrappy.ADD_TITLE"})),s.addClass("placeholder-text")):(s.set("text",t),s.setHTML(r.addLinkToHash(s.get("text").replace(/</g,"&lt;").replace(/>/g,"&gt;")))),n===""?(o.setHTML(r.intlMessage({intlName:"photo-page-scrappy.ADD_DESCRIPTION"})),o.addClass("placeholder-text")):o.setHTML(e.Handlebars.helpers.photoDescription(n).toString()),r.fixEmoji()},function(t){i.setValue("title",p),i.setValue("description",d),r.fire("subviewViewEvent","getDialogOffset",function(t){var n=e.Views.dialog.getInstance("dialog-alert",{content:r.intlMessage({intlName:"photo-page-scrappy.TITLE_DESCRIPTION_FAILURE"}),attrs:{title:r.intlMessage({intlName:"common.ERROR"}),level:"warning",confirmLabel:r.intlMessage({intlName:"common.OK"})},appContext:r.appContext,offsetLeft:t,dialogClass:"scrappy-dialog"});n.show()}),s.set("contenteditable","true"),o.set("contenteditable","true"),s.removeClass("disabled"),o.removeClass("disabled"),i.getValue("title")===""?(s.setHTML(this.intlMessage({intlName:"photo-page-scrappy.ADD_TITLE"})),s.addClass("placeholder-text")):(s.set("text",i.getValue("title")),s.setHTML(r.addLinkToHash(s.get("text").replace(/</g,"&lt;").replace(/>/g,"&gt;"))),r.fixEmoji()),i.getValue("description")===""?(o.setHTML(this.intlMessage({intlName:"photo-page-scrappy.ADD_DESCRIPTION"})),o.addClass("placeholder-text")):o.setHTML(e.Handlebars.helpers.photoDescription(i.getValue("description")).toString()),r.toggleTitleDesc({show:!1,noEffect:!0})})},startEditingAttr:function(t){var n=this,r=this.get("container"),i=this.get("photo"),s=i.getValue("title"),o=i.getValue("description"),u=r.one(".photo-title"),a=r.one(".photo-desc"),f=r.one(".edit-photo-title"),l=r.one(".edit-photo-desc"),c=r.one(".false-edit-photo-title"),h=r.one(".false-edit-photo-desc"),p,d,v;if(u.hasClass("disabled")||a.hasClass("disabled"))return;r.addClass("editing"),e.one("body").append(this.templates("editing-shim")()),this.registerEventHandler(e.one("body").one(".editing-shim").on("click",function(){n.doneEditingAttr()},this)),this.registerEventHandler(e.one("body").one(".editing-shim").on("focus",function(){n.doneEditingAttr()},this)),p=s,d=o,u.hasClass("placeholder-text")&&(p="",f.set("placeholder",this.intlMessage({intlName:"photo-page-scrappy.ADD_TITLE"}))),a.hasClass("placeholder-text")?(d="",l.set("placeholder",this.intlMessage({intlName:"photo-page-scrappy.ADD_DESCRIPTION"})),l.set("value",this.unwrapDescription(d)),h.set("value",this.unwrapDescription(d))):(v=d.replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<"),l.set("value",this.unwrapDescription(v)),h.set("value",this.unwrapDescription(v))),f.set("value",this.unwrapDescription(p)),c.set("value",this.unwrapDescription(p)),f.addClass("show-editable"),u.addClass("show-editable"),this.fixEmoji(),h._node.scrollHeight>420?l.setStyle("height","420px"):l.setStyle("height",h._node.scrollHeight+"px"),l.setStyle("minHeight","80px"),l.addClass("show-editable"),a.addClass("show-editable"),r.one(".edit-photo-title").focus(),r.one(".edit-photo-title").getDOMNode().setSelectionRange(0,r.one(".edit-photo-title").getDOMNode().value.length),this.toggleTitleDesc({showButton:!1,show:!0,noEffect:!0})},editButtonClickHandler:function(e){if(e.target.hasClass("title-desc-edit")||e.target.get("tagName").toLowerCase()!=="a"){e.preventDefault();var t=this.get("container"),n=t.one(".edit-photo-title"),r=t.one(".photo-title"),i=t.one(".photo-desc");if(r.hasClass("disabled")||i.hasClass("disabled"))return;t.hasClass("editing")||(this.startEditingAttr(n),t.one(".done-editing-title-desc").setStyle("display","block"))}},toggleTitleDesc:function(e){var t=this.get("container"),n;this.full=e.show||!this.full,this.full?(e.noEffect||this.fire("flickr:expand-sidebar"),t.one(".title-desc-block").addClass("showFull")):(t.one(".title-desc-block").removeClass("showFull"),e.noEffect||this.fire("flickr:collapse-sidebar")),t.one(".title-desc-more-button")&&(this.toggleTitleDescTruncationButton(),n=typeof e.showButton!="undefined"?e.showButton:this.titleDescHasOverflow(),this.showMoreButton(n))},toggleTitleDescTruncationButton:function(){var e=this.get("container");this.full?e.one(".title-desc-more-button").setHTML("less"):e.one(".title-desc-more-button").setHTML("more")},showMoreButton:function(e){var t=this.get("container"),n=t.one(".title-desc-more-button");e?n.addClass("title-desc-has-overflow"):n.removeClass("title-desc-has-overflow")},titleDescHasOverflow:function(){var e=this.get("container"),t=e.one(".title-desc-block"),n=t.getDOMNode(),r;return t&&t.getComputedStyle?r=parseInt((t.getComputedStyle("maxHeight")||""+n.clientHeight).replace("px",""),10):r=n.clientHeight,n.clientHeight<n.scrollHeight&&n.scrollHeight>r},activate:function(){var e=this.get("container"
),t=this.get("photo"),n=e.one(".title-desc-more-button"),r=this,i=t.getValue("title"),s=t.getValue("description"),o={title:!1,desc:!1};if(this.isMobile){var u=e.all(".hide-editable");u&&u.removeClass("hide-editable")}if(i.trim()===""||i.toUpperCase()==="<BR>")o.title=!0;return s.trim()===""&&(o.desc=!0),o.title&&o.desc&&!t.getValue("isOwner")&&e.setStyle("marginTop","0"),e&&(e.one(".photo-title")&&e.one(".photo-title").setHTML(this.addLinkToHash(e.one(".photo-title").getHTML())),this.fixEmoji(),n&&r.showMoreButton(r.titleDescHasOverflow())),n&&r.registerEventHandler(n.on("click",r.showFull,r)),t&&t.getValue("isOwner")&&[{field:".photo-title",editField:".edit-photo-title",editFalseField:".false-edit-photo-title"},{field:".photo-desc",editField:".edit-photo-desc",editFalseField:".false-edit-photo-desc"}].forEach(function(t){t.field!==".photo-tags"&&(o.desc&&o.title&&(e.addClass("editing"),e.one(".photo-title").addClass("show-editable"),e.one(".edit-photo-title").addClass("show-editable"),e.one(".edit-photo-title").setHTML("add title"),e.one(".edit-photo-title").addClass("placeholder-text"),e.one(".edit-photo-title").set("placeholder",r.intlMessage({intlName:"photo-page-scrappy.ADD_TITLE"})),e.one(".photo-desc").addClass("show-editable"),e.one(".edit-photo-desc").addClass("show-editable"),e.one(".edit-photo-desc").addClass("placeholder-text"),e.one(".edit-photo-desc").set("placeholder",r.intlMessage({intlName:"photo-page-scrappy.ADD_DESCRIPTION"})),e.one(".done-editing-title-desc").setStyle("display","none")),r.registerEventHandler(e.one(".title-desc-edit").on("click",r.editButtonClickHandler,r)),r.registerEventHandler(e.on("click",function(e){r.editButtonClickHandler(e)},r)),r.registerEventHandler(e.one(t.editField).on("focus",function(t){e.one(".done-editing-title-desc").setStyle("display","block")})),r.registerEventHandler(e.one(t.editField).on("valuechange",function(n){r.fixEmoji(),e.one(t.editFalseField).set("value",e.one(t.editField).get("value")),t.editField!==".edit-photo-title"&&(e.one(t.editFalseField)._node.scrollHeight>420?e.one(t.editField).setStyle("height","420px"):e.one(t.editField).setStyle("height",e.one(t.editFalseField)._node.scrollHeight+"px"))})),r.registerEventHandler(e.one(".done-editing-title-desc").on("click",function(e){e.preventDefault(),r.doneEditingAttr()},r)),r.registerEventHandler(e.one(t.editField).on("keydown",function(n){n.charCode===13&&(n.ctrlKey||n.metaKey)||t.editField===".edit-photo-title"&&n.charCode===13?(n.preventDefault(),r.doneEditingAttr(),e.one(t.editField).blur()):(e.one(t.editFalseField).set("value",e.one(t.editField).get("value")),t.editField!==".edit-photo-title"&&(e.one(t.editFalseField)._node.scrollHeight>420?e.one(t.editField).setStyle("height","420px"):e.one(t.editField).setStyle("height",e.one(t.editFalseField)._node.scrollHeight+"px")))})))}),this}})},"@VERSION@",{requires:["flickr-view","hermes-template-sub-photo-title-desc","hermes-template-editing-shim","editing-shim-css","sub-photo-title-desc-css","array-extras","handlebars-helpers"],optional:["photo-models","photo-tags-models","photo-stats-models"],langBundles:["common","photo-page-scrappy"]});
YUI.add("hermes-template-photo-license",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){var r="",i,s,o;r+="\n            ",i=n["if"].call(e,e.licenseIsCreativeCommons,{hash:{},inverse:l.program(4,p,t),fn:l.program(2,h,t),data:t});if(i||i===0)r+=i;r+="\n            ",i=n["if"].call(e,e.licenseisGovt,{hash:{},inverse:l.noop,fn:l.program(9,m,t),data:t});if(i||i===0)r+=i;r+="\n            ",i=n["if"].call(e,e.licenseisNoLic,{hash:{},inverse:l.noop,fn:l.program(11,g,t),data:t});if(i||i===0)r+=i;r+="\n            ",i=n["if"].call(e,e.licenseisCopy,{hash:{},inverse:l.noop,fn:l.program(13,y,t),data:t});if(i||i===0)r+=i;r+="\n            ",i=n["if"].call(e,e.licenseIsPDW,{hash:{},inverse:l.noop,fn:l.program(15,b,t),data:t});if(i||i===0)r+=i;r+='\n        </a>\n        <div class="ui-dropdown ui-dropdown-closed">\n            <span class="ui-dialog-arrow"></span>\n            <ul>\n                    ',o={hash:{},inverse:l.noop,fn:l.program(17,w,t),data:t},s=(i=n.eachConfigVal||e.eachConfigVal,i?i.call(e,"licenseSelect",o):u.call(e,"eachConfigVal","licenseSelect",o));if(s||s===0)r+=s;return r+="\n            </ul>\n        </div>\n    ",r}function h(e,t){var r="",i,s,o;return r+='\n                <a href="',o={hash:{},data:t},r+=a((i=n.configVal||e.configVal,i?i.call(e,"licenseUrls",e.license,o):u.call(e,"configVal","licenseUrls",e.license,o)))+'" class="photo-license-url-iconOnly" rel="license cc:license" target="_newtab">\n                <i class="ui-icon-tiny-',(s=n.license)?s=s.call(e,{hash:{},data:t}):(s=e.license,s=typeof s===f?s.apply(e):s),r+=a(s)+'cc"></i>\n            ',r}function p(e,t){var r="",i;r+="\n                ",i=n["if"].call(e,e.licenseisNoLic,{hash:{},inverse:l.program(7,v,t),fn:l.program(5,d,t),data:t});if(i||i===0)r+=i;return r+="\n            ",r}function d(e,t){var r="",i,s;return r+='\n                    <a href="',s={hash:{},data:t},r+=a((i=n.configVal||e.configVal,i?i.call(e,"licenseUrls",e.license,s):u.call(e,"configVal","licenseUrls",e.license,s)))+'" class="photo-license-url" rel="license" target="_newtab">\n                ',r}function v(e,t){var r="",i,s;return r+='\n                    <a href="',s={hash:{},data:t},r+=a((i=n.configVal||e.configVal,i?i.call(e,"licenseUrls",e.license,s):u.call(e,"configVal","licenseUrls",e.license,s)))+'" class="photo-license-url-iconOnly" rel="license" target="_newtab">\n                ',r}function m(e,t){return'\n                <i class="ui-icon-tiny-government"></i>\n            '}function g(e,t){return'\n                <i class="ui-icon-tiny-noKnown"></i>\n            '}function y(e,t){return'\n                <i class="ui-icon-tiny-copyright"></i>\n            '}function b(e,t){return'\n                <i class="ui-icon-tiny-10cc"></i>\n            '}function w(e,t){var r="",i,s;return r+='\n                       <li data-action="set" data-value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===f?i.apply(e):i),r+=a(i)+'" data-text="',s={hash:{intlName:e.key},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+'">',s={hash:{intlName:e.key},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"</li>\n                    ",r}function E(e,t){var r="",i,s,o;r+='\n		<a href="',o={hash:{},data:t},r+=a((i=n.configVal||e.configVal,i?i.call(e,"licenseUrls",e.license,o):u.call(e,"configVal","licenseUrls",e.license,o)))+'" class="photo-license-url" rel="license cc:license" target="_newtab">\n			',s=n["if"].call(e,e.licenseIsCreativeCommons,{hash:{},inverse:l.program(22,x,t),fn:l.program(20,S,t),data:t});if(s||s===0)r+=s;r+="\n			",s=n["if"].call(e,e.licenseisGovt,{hash:{},inverse:l.noop,fn:l.program(27,C,t),data:t});if(s||s===0)r+=s;r+="\n			",s=n["if"].call(e,e.licenseisNoLic,{hash:{},inverse:l.noop,fn:l.program(29,k,t),data:t});if(s||s===0)r+=s;r+="\n			",s=n["if"].call(e,e.licenseisCopy,{hash:{},inverse:l.noop,fn:l.program(31,L,t),data:t});if(s||s===0)r+=s;r+="\n			",s=n["if"].call(e,e.licenseIsCreativeCommons,{hash:{},inverse:l.program(38,_,t),fn:l.program(33,A,t),data:t});if(s||s===0)r+=s;return r+="\n		</a>\n    ",r}function S(e,t){var r="",i;return r+='\n				<i class="ui-icon-tiny-',(i=n.license)?i=i.call(e,{hash:{},data:t}):(i=e.license,i=typeof i===f?i.apply(e):i),r+=a(i)+'cc"></i>\n			',r}function x(e,t){var r="",i;r+="\n                ",i=n["if"].call(e,e.licenseisNoLic,{hash:{},inverse:l.program(25,N,t),fn:l.program(23,T,t),data:t});if(i||i===0)r+=i;return r+="\n			",r}function T(e,t){var r="",i,s;return r+='\n				    <a href="',s={hash:{},data:t},r+=a((i=n.configVal||e.configVal,i?i.call(e,"licenseUrls",e.license,s):u.call(e,"configVal","licenseUrls",e.license,s)))+'" class="photo-license-url" rel="license" target="_newtab">\n                ',r}function N(e,t){var r="",i;return r+='\n                    <i class="ui-icon-tiny-',(i=n.license)?i=i.call(e,{hash:{},data:t}):(i=e.license,i=typeof i===f?i.apply(e):i),r+=a(i)+'cc"></i>\n                ',r}function C(e,t){return'\n				<i class="ui-icon-tiny-government"></i>\n			'}function k(e,t){return'\n				<i class="ui-icon-tiny-noKnown"></i>\n			'}function L(e,t){return'\n				<i class="ui-icon-tiny-copyright"></i>\n			'}function A(e,t){var r="",i;r+="\n                ",i=n["if"].call(e,e.licenseIsCC0,{hash:{},inverse:l.program(36,M,t),fn:l.program(34,O,t),data:t});if(i||i===0)r+=i;return r+="\n			",r}function O(e,t){var r="",i,s;return r+="\n				    <span>",s={hash:{intlName:"photo-page-scrappy.PUBLIC_DOMAIN"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"</span>\n                ",r}function M(e,t){var r="",i,s;return r+="\n                    <span>",s={hash:{intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"</span>\n                ",r}function _(e,t){var r="",i;r+="\n                ",i=n["if"].call(e,e.licenseIsPDW
,{hash:{},inverse:l.program(41,P,t),fn:l.program(39,D,t),data:t});if(i||i===0)r+=i;return r+="\n			",r}function D(e,t){var r="",i,s;return r+="\n                        <span>",s={hash:{intlName:"photo-page-scrappy.PUBLIC_DOMAIN"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"</span>\n                ",r}function P(e,t){var r="",i,s,o;r+="\n    				<span>\n    					",o={hash:{},inverse:l.noop,fn:l.program(42,H,t),data:t},s=(i=n.licenseString||e.licenseString,i?i.call(e,e.license,o):u.call(e,"licenseString",e.license,o));if(s||s===0)r+=s;return r+="\n    				</span>\n                ",r}function H(e,t){var r="",i,s;return r+="\n    						",s={hash:{intlName:e.key},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"\n    					",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=n.helperMissing,a=this.escapeExpression,f="function",l=this;s+=' <div class="photo-license-info">\n    ',o=n["if"].call(t,t.licenseIsEditable,{hash:{},inverse:l.program(19,E,i),fn:l.program(1,c,i),data:i});if(o||o===0)s+=o;return s+="\n </div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-license",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-license-view",function(e){var t;t={debug:!1,css:{license:".photo-license-info .ui-dropdown"},stateCSS:{working:"working",apiError:"api-error"}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.photoId=t.photoId,this.context=e.clone(t.context,!0),this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},buildContainer:function(){var e,t=this.get("photo"),n=t.getValue("isOwner"),r=t?t.getValue("license"):"none";return e=this.templates("photo-license")({license:r,licenseIsEditable:n&&r!==7&&r!==8,licenseIsCreativeCommons:r!==0&&r!==7&&r!==8&&r!==10,licenseisGovt:r===8,licenseisNoLic:r===7,licenseisCopy:r===0,licenseIsCC0:r===9,licenseIsPDW:r===10}),this.setContainerHTML(e),this},loadState:function(){var t=this,n=new e.FlickrPromise({photo:t.appContext.getModel("photo-models",t.photoId)});return n.then(function(e){t.set("photo",e.photo)})},setLicense:function(e){var n=this.get("photo"),r=n.getValue("license"),i=this.mapLicenseUrl(r),s=this.get("container").one(".photo-license-info"),o=this.get("container").one(".photo-license-info a"),u=parseInt(e,10)!==0&&parseInt(e,10)!==7&&parseInt(e,10)!==8,a=this.mapLicenseUrl(e),f=this;s&&(s.removeClass(t.stateCSS.apiError),s.addClass(t.stateCSS.working)),n.setValue("license",e),u?(o.one("i").removeClass("ui-icon-tiny-copyright"),o.one("i").removeClass("ui-icon-tiny-"+r+"cc"),o.one("i").addClass("ui-icon-tiny-"+e+"cc"),this.get("container").one(".photo-license-url-iconOnly").set("rel","license cc:license")):(o.one("i").removeClass("ui-icon-tiny-"+r+"cc"),o.one("i").addClass("ui-icon-tiny-copyright"),this.get("container").one(".photo-license-url-iconOnly").set("rel","license")),o.setAttribute("href",a),n.remoteUpdate().then(function(){s&&s.removeClass(t.stateCSS.working)},function(e){n.setValue("license",r),f.licenseDd.select(r),o.setAttribute("href",i),s&&(s.removeClass(t.stateCSS.working),s.addClass(t.stateCSS.apiError)),f.onError(f.intlMessage({intlName:"photo-page-scrappy.LICENSE_ERROR"})),f.appContext.error(e)}.bind(this))},mapLicenseUrl:function(e){var t=["https://help.yahoo.com/kb/flickr/SLN25525.html?impressions=true","https://creativecommons.org/licenses/by-nc-sa/2.0/","https://creativecommons.org/licenses/by-nc/2.0/","https://creativecommons.org/licenses/by-nc-nd/2.0/","https://creativecommons.org/licenses/by/2.0/","https://creativecommons.org/licenses/by-sa/2.0/","https://creativecommons.org/licenses/by-nd/2.0/","/commons/usage/","http://www.usa.gov/copyright.shtml","https://creativecommons.org/publicdomain/zero/1.0/","https://creativecommons.org/publicdomain/mark/1.0/"];return t[e]},mapLicense:function(e){var t=[this.intlMessage({intlName:"photo-page-scrappy.ALL_RIGHTS_RESERVED"}),this.intlMessage({intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"}),this.intlMessage({intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"}),this.intlMessage({intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"}),this.intlMessage({intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"}),this.intlMessage({intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"}),this.intlMessage({intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"}),this.intlMessage({intlName:"photo-page-scrappy.NO_RESTRICTIONS"}),this.intlMessage({intlName:"photo-page-scrappy.USA_GOV_WORK"}),this.intlMessage({intlName:"photo-page-scrappy.PUBLIC_DOMAIN"}),this.intlMessage({intlName:"photo-page-scrappy.PUBLIC_DOMAIN"})];return t[e]},activate:function(){var n=this.get("container"),r=this.get("photo"),i=this;return this.licenseDd=new e.Views.Dropdown({appContext:this.appContext,container:n.one(t.css.license),selected:r.getValue("license"),disabled:!r.getValue("isOwner"),labelFunction:function(e){return i.mapLicense(r.getValue("license"))}}),this.licenseDd.on("open",function(t){i.fire("viewEvent","make in view",i.licenseDd.get("container")),e.rapidTracker.beacon(i.name,"licenseSettingMenuClick")}),this.licenseDd.on("close",function(e){i.fire("viewEvent","close in view")}),this.licenseDd.on("selected",function(e){i.setLicense(e.clicked.value)}),this.on("destroy",function(){i.licenseDd.destroy()}),this}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-license","photo-license-css"],langBundles:["common","photo-page-scrappy","settings"]});
YUI.add("hermes-template-confirmation-dialog",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return'\n<div class="delete-image-dialog-content">\n	<div class="delete-image-image">\n	        <img class="photo-to-delete" />\n	</div>\n</div>\n\n'}function d(e,t){var r="",i,s,o;r+='\n<div class="dialog-content">\n	',i=n["if"].call(e,e.icon,{hash:{},inverse:c.noop,fn:c.program(4,v,t),data:t});if(i||i===0)r+=i;return r+='\n	<div class="dialog-description">\n		<div>',o={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e.content,!1,o):h.call(e,"outlet",e.content,!1,o)))+" ",(s=n.deletePhotoConfirmation)?s=s.call(e,{hash:{},data:t}):(s=e.deletePhotoConfirmation,s=typeof s===f?s.apply(e):s),r+=l(s)+"</div>\n	</div>\n</div>\n",r}function v(e,t){var r="",i;return r+='\n		<i class="dialog-icon ',(i=n.icon)?i=i.call(e,{hash:{},data:t}):(i=e.icon,i=typeof i===f?i.apply(e):i),r+=l(i)+'"></i>\n	',r}function m(e,t){var r="",i,s;return r+='\n	<button class="ui-button ui-button-cta ui-dialog-button-confirm"><span>',s={hash:{intlName:"photo-page-scrappy.GO_TO_ORGANIZER"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+"</span></button>\n",r}function g(e,t){var r="",i;r+="\n	",i=n["if"].call(e,e.showConfirmButton,{hash:{},inverse:c.noop,fn:c.program(9,y,t),data:t});if(i||i===0)r+=i;r+="\n	",i=n["if"].call(e,e.showCancelButton,{hash:{},inverse:c.noop,fn:c.program(11,b,t),data:t});if(i||i===0)r+=i;r+="\n	",i=n["if"].call(e,e.showAuxiliaryButton,{hash:{},inverse:c.noop,fn:c.program(13,w,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function y(e,t){var r="",i;return r+='\n		<button class="ui-button ui-button-cta ui-dialog-button-confirm ',(i=n.confirmButtonClass)?i=i.call(e,{hash:{},data:t}):(i=e.confirmButtonClass,i=typeof i===f?i.apply(e):i),r+=l(i)+'"><span>',(i=n.confirmButtonLabel)?i=i.call(e,{hash:{},data:t}):(i=e.confirmButtonLabel,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span></button>\n	",r}function b(e,t){var r="",i;return r+='\n		<button class="ui-button ui-button-cta ui-dialog-button-confirm ui-dialog-button-cancel ',(i=n.cancelButtonClass)?i=i.call(e,{hash:{},data:t}):(i=e.cancelButtonClass,i=typeof i===f?i.apply(e):i),r+=l(i)+'"><span>',(i=n.cancelButtonLabel)?i=i.call(e,{hash:{},data:t}):(i=e.cancelButtonLabel,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span></button>\n	",r}function w(e,t){var r="",i;return r+='\n		<button class="ui-button ui-button-cta ui-dialog-button-confirm auxiliary-confirmation ',(i=n.auxiliaryButtonClass)?i=i.call(e,{hash:{},data:t}):(i=e.auxiliaryButtonClass,i=typeof i===f?i.apply(e):i),r+=l(i)+'"><span>',(i=n.auxiliaryButtonLabel)?i=i.call(e,{hash:{},data:t}):(i=e.auxiliaryButtonLabel,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span></button>\n	",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<div class="dialog-title">\n		<h3>',a={hash:{},data:i},s+=l((o=n.renderTrustedMarkup||t.renderTrustedMarkup,o?o.call(t,t.title,a):h.call(t,"renderTrustedMarkup",t.title,a)))+'</h3>\n		<i class="cancel-confirmation ui-dialog-button-close"></i>\n</div>\n\n',u=n["if"].call(t,t.deletePhotoConfirmation,{hash:{},inverse:c.program(3,d,i),fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;s+="\n\n",u=n["if"].call(t,t.organizrLink,{hash:{},inverse:c.program(8,g,i),fn:c.program(6,m,i),data:i});if(u||u===0)s+=u;return s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/confirmation-dialog",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-lang-shared-entity",function(e,t){e.Intl.add("hermes/shared-entity","en-US",{USERNAME_HAS_SHARED_PHOTOS_ONLY:["${username}"," has shared ",{type:"plural",valueName:"photoCount",options:{one:"${#} photo",other:"${#} photos"}}," with you!"],USERNAME_HAS_SHARED_VIDEOS_ONLY:["${username}"," has shared ",{type:"plural",valueName:"videoCount",options:{one:"${#} video",other:"${#} videos"}}," with you!"],USERNAME_HAS_SHARED_PHOTOS_VIDEOS:["${username}"," has shared ",{type:"plural",valueName:"photoCount",options:{one:"${#} photo",other:"${#} photos"}}," ",{type:"plural",valueName:"videoCount",options:{one:"and ${#} video",other:"and ${#} videos"}}," with you!"],OWNER_HAS_SHARED_PHOTOS_ONLY:["You have shared ",{type:"plural",valueName:"photoCount",options:{one:"${#} photo",other:"${#} photos"}},"."],OWNER_HAS_SHARED_VIDEOS_ONLY:["You have shared ",{type:"plural",valueName:"videoCount",options:{one:"${#} video",other:"${#} videos"}},"."],OWNER_HAS_SHARED_PHOTOS_VIDEOS:["You have shared ",{type:"plural",valueName:"photoCount",options:{one:"${#} photo",other:"${#} photos"}}," ",{type:"plural",valueName:"videoCount",options:{one:"and ${#} video",other:"and ${#} videos"}},"."],VIEW_YOUR_SHARING_HISTORY:["View your sharing history"]})},"@VERSION@",{requires:["intl"]});
YUI.add("photo-contexts-models",function(e){function t(e){t.superclass.constructor.call(this,e),this.getMorePromises={"group-pool-models":{},"set-models":{},"gallery-models":{}},this.continuationKeys={"group-pool-models":{},"set-models":{},"gallery-models":{}}}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return this.appContext.flipper.isFlipped("enable-scrappy-photo-page")?e.ModelFetchers["flickr-photos-getAllContexts"].run(t,this.appContext):e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)}},getMoreContextsOfType:function(t,n,r){var i=this,s,o,u,a,f,l,c,h="-1",p=e.APIHelper.request.getRebootPhotoExtras();switch(n){case"group-pool-models":s="flickr.photos.getGroups",u="groups.group",p+=","+e.APIHelper.request.getRebootGroupExtras();break;case"set-models":s="flickr.photos.getSets",u="sets.set";break;case"gallery-models":s="flickr.photos.getGalleries",u="galleries.gallery"}return s?this.exists(t)?(a=this.continuationKeys[n][t]||"0",a===h?e.Promise.resolve({type:n,newContexts:[],loadedAll:!0}):(o={photo_id:t,extras:p,primary_photo_extras:"url_sq, url_t, url_s, url_m",continuation:a,per_page:r},l=t+"_"+a,c=this.getMorePromises[n][l],c?c:(this.getMorePromises[n][l]=(new e.FlickrPromise({apiResponse:this.appContext.callAPI(s,o,!0),contextRegistry:this.appContext.getModelRegistry(n),personRegistry:this.appContext.getModelRegistry("person-models")})).then(function(r){var s=[],o=r.apiResponse,a=r.contextRegistry,c=r.personRegistry,p,d,v;return d=u.split(".").reduce(function(t,n){return e.Lang.isObject(t)?t[n]:undefined},o),d&&(e.Array.each(d,function(t){e.APIHelper.response.addContextToRegistry(t,a,c),s.push(a.proxy(t.id))}),s.length&&(v=i.getContextsOfType(t,n).map(function(e){return e.getValue("id")}),s=s.filter(function(e){return v.indexOf(e.getValue("id"))===-1}),s.length&&i.getValue(t,"contexts").appendToListMulti(s))),f=o.continuation,typeof f=="undefined"?f=h:e.Lang.isNumber(f)&&(f+=""),p=f===h,i.continuationKeys[n][t]=f,delete i.getMorePromises[n][l],{type:n,newContexts:s,loadedAll:p}}),this.getMorePromises[n][l]))):e.Promise.reject("[photo-contexts-models] getMoreContextsOfType was called for an ID that isn't in the registry: "+t):e.Promise.reject("[photo-contexts-models] getMoreContextsOfType was called without an invalid type: "+n)},getContextsOfType:function(t,n){return n=e.Array(n),this.getValue(t,"contexts").getList().filter(function(e){return n.indexOf(e.registry.name)>-1})},getContextsNotOfType:function(t,n){return n=e.Array(n),this.getValue(t,"contexts").getList().filter(function(e){return n.indexOf(e.registry.name)===-1})},attributes:{contexts:{isCollection:!0},totalGroups:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},totalSets:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},totalGalleries:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0}}})},"@VERSION@",{requires:["api-helper","flickr-model-registry","flickr-promise","flickr-photos-getInfo-fetcher","flickr-photos-getAllContexts-fetcher"]});
YUI.add("flickr-favorites-getContext-fetcher",function(e,t){"use strict";function n(t){var n={photo_id:t.photoId,num_prev:t.numNext,num_next:t.numPrev,extras:e.APIHelper.request.getRebootPhotoExtras()};return t.id?n.user_id=t.id:n.path_alias=t.pathAlias,n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=[],c=[],h=s.proxy(n.photoId),p,d,v,m,g,y,b=[];return p=r.prevphotos,d=r.nextphotos,c=e.APIHelper.response.parsePhotos({photos:p.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),l=e.APIHelper.response.parsePhotos({photos:d.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),y=i.getValue(n.id,"photoContextList"),m=y.hasMinBoundary?y.hasMinBoundary():!1,g=y.hasMaxBoundary?y.hasMaxBoundary():!1,v=y.getList(),b=e.APIHelper.response.addOrReplaceListByContext({model:h,next:c,prev:l.reverse(),hasMax:g,hasMin:m,current:v,numNext:n.numNext,numPrev:n.numPrev}),i.setValue(n.id,"photoContextList",b),{next:c,previous:l.reverse()}}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.favorites.getContext",this._processParams(n),!0),r.getModelRegistry("favorite-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-curation-models")]).then(function(e){return i._processResponse(e,n)},function(e){throw e.code===3&&e.message==="Photo not a favorite"&&(e.notInContext=!0),e}).then(null,e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-favorites-getContext"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper","type-validator"],optional:["favorite-models","photo-models","person-models","photo-engagement-models","photo-stats-models","photo-curation-models"]});
YUI.add("flickr-favorites-getList-fetcher",function(e,t){"use strict";function n(t){var n={extras:e.APIHelper.request.getRebootPhotoExtras(),per_page:t.perPage||20,page:t.page||1,get_user_info:1,jump_to:t.withPhotoId||""};if(t.id||t.userId)n.user_id=(t.id||t.userId).split("-")[0];else{if(!t.pathAlias)throw new Error("[flickr-favorites-getList-fetcher] `id` or `pathAlias` is required.");n.path_alias=t.pathAlias}return n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l,c={id:r.user.nsid,pathAlias:r.user.pathAlias,totalItems:r.photos.total},h,p=n.id||n.userId;return p&&p!==c.id&&(c.id=p),h=e.APIHelper.response.parsePerson(r.user),c.owner=s.addOrUpdate(h),l=e.APIHelper.response.parsePhotos({photos:r.photos.photo,personModelRegistry:s,photoModelRegistry:i,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),c.photoPageList={perPage:r.photos.perpage,page:r.photos.page,pageContent:l,totalItems:r.photos.total},o.addOrUpdate(c),l}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.favorites.getList",this._processParams(n)),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("favorite-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-curation-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-favorites-getList"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-models","person-models","favorite-models","photo-engagement-models","photo-stats-models","photo-curation-models"]});
YUI.add("favorite-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-favorites-getList"].run(t,this.appContext)}},attributes:{normalizedId:{readOnly:!0,defaultFn:function(e){return e.split("-")[0]}},displayType:{readOnly:!0,defaultFn:function(){return"favorites"}},title:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.appContext.getViewer(),n=this.getValue(e,"normalizedId"),r;return t&&t.nsid===n?"Your favorites":(r=this.getValue(e,"owner"),r?r.getValue("displayname")+"'s favorites":"Favorites")}},pathAlias:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||undefined},defaultFn:function(e){return this.getValue(e,"normalizedId")}},owner:{isModel:!0},isOwner:e.PhotoModelHelper.attributes.isOwner,photoPageList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-favorites-getList"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-favorites-getContext"],listItemIdField:"photoId"}},url:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.getValue(e,"owner"),n=this.getValue(e,"normalizedId"),r=t?t.getValue("pathAlias"):n;return"/photos/"+r+"/favorites/"}},totalItems:{defaultFn:function(){return null}},urlSuffix:{readOnly:!0,derivedBy:["owner"],defaultFn:function(e){var t=this.getValue(e,"owner"),n=t.getValue("pathAlias");return"faves-"+n}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-favorites-getContext-fetcher","flickr-favorites-getList-fetcher","photo-model-helper"]});
YUI.add("flickr-galleries-getPhotos-fetcher",function(e,t){"use strict";function n(t){var n={gallery_id:t.compoundId,extras:e.APIHelper.request.getRebootPhotoExtras(),per_page:t.perPage||1,page:t.page||20,get_user_info:1,get_gallery_info:1,primary_photo_extras:"url_sq, url_t, url_s, url_m"};return n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l;if(r&&r.gallery)return r.gallery.owner=r.user,r.gallery.title=r.gallery.title&&r.gallery.title.content,r.gallery.description=r.gallery.description&&r.gallery.description.content,r.gallery.photoCount=r.gallery.countPhotos,r.gallery.videoCount=r.gallery.countVideos,e.APIHelper.response.addContextToRegistry(r.gallery,o,s),l=e.APIHelper.response.parsePhotos({photos:r.photos.photo,personModelRegistry:s,photoModelRegistry:i,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),o.setValue(n.id,"photoPageList",l),l}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.galleries.getPhotos",this._processParams(n),!0),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("gallery-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-curation-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-galleries-getPhotos"]={run:i,_processResponse:r,_processParams:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-models","person-models","gallery-models","photo-engagement-models","photo-stats-models","photo-curation-models"]});
YUI.add("flickr-galleries-getContext-fetcher",function(e,t){"use strict";function n(t){var n={gallery_id:t.compoundId,photo_id:t.photoId,extras:e.APIHelper.request.getRebootPhotoExtras(),num_prev:t.numPrev,num_next:t.numNext};return n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=[],c=[],h=s.proxy(n.photoId),p,d,v,m,g,y,b=[];return p=r.nextphotos,d=r.prevphotos,c=e.APIHelper.response.parsePhotos({photos:p.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),l=e.APIHelper.response.parsePhotos({photos:d.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),y=i.getValue(n.id,"photoContextList"),m=y.hasMinBoundary?y.hasMinBoundary():!1,g=y.hasMaxBoundary?y.hasMaxBoundary():!1,v=y.getList(),b=e.APIHelper.response.addOrReplaceListByContext({model:h,next:c,prev:l.reverse(),current:v,hasMin:m,hasMax:g,numNext:n.numNext,numPrev:n.numPrev}),i.setValue(n.id,"photoContextList",b),{next:c,previous:l.reverse()}}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.galleries.getContext",this._processParams(n),!0),r.getModelRegistry("gallery-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-curation-models")]).then(function(e){return i._processResponse(e,n)},function(e){throw e.code===3&&e.message==="Photo not in gallery"&&(e.notInContext=!0),e}).then(null,e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-galleries-getContext"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["gallery-models","photo-models","person-models","photo-engagement-models","photo-stats-models","photo-curation-models"]});
YUI.add("photo-galleries-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getAllContexts"].run(t,this.appContext)}},attributes:{id:{},galleries:{isListProxy:!0},total:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0}}})},"@VERSION@",{requires:["api-helper","flickr-model-registry","flickr-promise","flickr-photos-getAllContexts-fetcher"]});
YUI.add("flickr-galleries-addPhoto-creator",function(e,t){"use strict";function n(n,r){var i={},s=n.galleryCompoundID.split("-").pop();return i.photo_id=n.photoID,i.gallery_id=n.galleryCompoundID,e.Promise.all([r.callAPI("flickr.galleries.addPhoto",i),r.getModel("gallery-models",s),r.getModel("photo-models",n.photoID),r.getModelRegistry("photo-galleries-models"),r.getModelRegistry("photo-contexts-models")]).then(function(t){var r=t[0],i=t[1],o=t[2],u=t[3],a=t[4],f,l;if(r.stat==="ok")return i&&!i.hasPhoto(o.getValue("id"))&&(i.addPhoto(o),o.getValue("isVideo")?i.setValue("videoCount",i.getValue("videoCount")+1):i.setValue("photoCount",i.getValue("photoCount")+1),1===i.getValue("photoCount")+i.getValue("videoCount")&&(f=o.getValue("sizes"),l={},e.Object.each(f,function(e,t){["m","s","sq","t"].indexOf(t)>-1&&(l[t]={width:e.width,height:e.height,src:e.url})}),i.setValue("primary",s),i.setValue("primaryPhotoSizes",l))),u.exists(n.photoID)&&!u.getValue(n.photoID,"galleries").getFromListByID(i.getValue("id"))&&(u.getValue(n.photoID,"galleries").prependToList(i),u.setValue(n.photoID,"total",u.getValue(n.photoID,"total")+1)),a.exists(n.photoID)&&!a.getValue(n.photoID,"contexts").getFromListByID(i.getValue("id"))&&(a.setValue(n.photoID,"totalGalleries",a.getValue(n.photoID,"totalGalleries")+1),a.getValue(n.photoID,"contexts").appendToList(i)),i},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-galleries-addPhoto"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:["gallery-models","photo-models","photo-galleries-models","photo-contexts-models"]});
YUI.add("flickr-galleries-removePhoto-deletor",function(e,t){"use strict";function n(n,r){var i={},s=n.galleryCompoundID.split("-").pop();return i.photo_id=n.photoID,i.gallery_id=n.galleryCompoundID,e.Promise.all([r.callAPI("flickr.galleries.removePhoto",i),r.getModel("gallery-models",s),r.getModel("photo-models",n.photoID),r.getModelRegistry("photo-galleries-models"),r.getModelRegistry("photo-contexts-models")]).then(function(e){var t=e[0],r=e[1],i=e[2],o=e[3],u=e[4];if(t.stat==="ok")return u.exists(n.photoID)&&u.getValue(n.photoID,"contexts").getFromListByID(s)&&(u.setValue(n.photoID,"totalGalleries",u.getValue(n.photoID,"totalGalleries")-1),u.getValue(n.photoID,"contexts").removeFromList(s)),o.exists(n.photoID)&&o.getValue(n.photoID,"galleries").getFromListByID(s)&&(o.setValue(n.photoID,"total",o.getValue(n.photoID,"total")-1),o.getValue(n.photoID,"galleries").removeFromList(s)),r&&(r.hasPhoto(i.getValue("id"))&&r.removePhoto(i),i.getValue("isVideo")?r.setValue("videoCount",r.getValue("videoCount")-1):r.setValue("photoCount",r.getValue("photoCount")-1),0===r.getValue("photoCount")+r.getValue("videoCount")&&(r.setValue("primary",null),r.setValue("primaryPhotoSizes",{}))),r},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-galleries-removePhoto"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:["gallery-models","photo-models","photo-galleries-models","photo-contexts-models"]});
YUI.add("flickr-galleries-getList-fetcher",function(e,t){"use strict";function n(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=r.galleries,a=n.id,f,l={},c=[];u&&(f=o.exists(a)?o.proxy(a):o.add(a),u.gallery&&e.Array.each(u.gallery,function(t,n){var r,i;r=t.id.split("-")[1],i={id:r,compoundId:t.id,title:t.title.content,description:t.description.content,owner:f,primary:t.primaryPhotoId,primaryPhotoSizes:e.APIHelper.response.parsePrimaryPhotoSizes(t),photoCount:t.countPhotos,videoCount:t.countVideos},c.push(s.addOrUpdate(i))}),l={id:a,galleries:c},i.exists(a)?i.setValues(a,l):i.add(l))}function r(n,r){var i=this,s={user_id:n.id,primary_photo_extras:"url_sq, url_t, url_s, url_m"};return e.Promise.all([r.callAPI("flickr.galleries.getList",s),r.getModelRegistry("person-galleries-models"),r.getModelRegistry("gallery-models"),r.getModelRegistry("person-models")]).then(function(e){i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-galleries-getList"]={run:r,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["person-galleries-models","gallery-models","person-models"]});
YUI.add("person-galleries-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-galleries-getList"].run(t,this.appContext)}},attributes:{id:{},galleries:{isListProxy:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-galleries-getList-fetcher"]});
YUI.add("flickr-galleries-create-creator",function(e,t){"use strict";function n(n,r){var i={};return i.title=n.title,i.description=n.description,i.primary_photo_id=n.photoID,i.full_result=1,e.Promise.all([r.callAPI("flickr.galleries.create",i),r.getModelRegistry("gallery-models"),r.getModel("photo-models",n.photoID),r.getModel("person-models",r.getViewer().nsid),r.getModel("person-galleries-models",r.getViewer().nsid),r.getModelRegistry("photo-galleries-models"),r.getModelRegistry("photo-contexts-models")]).then(function(t){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l,c=r.gallery.id,h=c.split("-")[1];return h?(l=i.add({id:h,compoundId:c,title:r.gallery.title.content,description:r.gallery.description.content,photoPageList:[s],photoContextList:[s],owner:o,primary:n.photoID,primaryPhotoSizes:e.APIHelper.response.parsePrimaryPhotoSizes(r.gallery),photoCount:s.getValue("isVideo")?0:1,videoCount:s.getValue("isVideo")?1:0}),u.getValue("galleries").prependToList(l),a.exists(n.photoID)&&!a.getValue(n.photoID,"galleries").getFromListByID(l.getValue("id"))&&(a.getValue(n.photoID,"galleries").prependToList(l),a.setValue(n.photoID,"total",a.getValue(n.photoID,"total")+1)),f.exists(n.photoID)&&!f.getValue(n.photoID,"contexts").getFromListByID(l.getValue("id"))&&(f.setValue(n.photoID,"totalGalleries",f.getValue(n.photoID,"totalGalleries")+1),f.getValue(n.photoID,"contexts").appendToList(l)),l):!1},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-galleries-create"]={run:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["gallery-models","photo-models","person-models","person-galleries-models","photo-galleries-models","photo-contexts-models"]});
YUI.add("gallery-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{langBundles:this.details.langBundles,name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-galleries-getPhotos"].run(t,this.appContext)},create:function(t,n){return e.ModelCreators["flickr-galleries-create"].run(t,n)},addPhoto:function(t,n){return e.ModelCreators["flickr-galleries-addPhoto"].run(t,n)},removePhoto:function(t,n){return e.ModelCreators["flickr-galleries-removePhoto"].run(t,n)}},addPhoto:function(e,t){return this.getValue(e,"photoPageList").hasMaxBoundary()&&this.getValue(e,"photoPageList").appendToList(t),this.getValue(e,"photoContextList").hasMaxBoundary()&&this.getValue(e,"photoContextList").appendToList(t),this},removePhoto:function(e,t){return this.getValue(e,"photoPageList").removeFromList(t.getValue("id")),this.getValue(e,"photoContextList").removeFromList(t.getValue("id")),this},hasPhoto:function(e,t){return this.getValue(e,"photoPageList").getFromListByID(t)||this.getValue(e,"photoContextList").getFromListByID(t)},attributes:{compoundId:{validator:function(t,n){return e.Lang.isString(t)&&t.indexOf("-")>-1}},displayType:{readOnly:!0,defaultFn:function(){return"gallery"}},title:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){var n=e.AttributeHelpers.coerceString(t);return n=n.replace(/\\'/,"'").replace(/\\"/,'"').replace(/\\\\/,"\\"),n},defaultValue:""},description:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},owner:{isModel:!0},photoPageList:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-galleries-getPhotos"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-galleries-getContext"],listItemIdField:"photoId"}},photoCount:{validator:function(t,n){return e.AttributeHelpers.validateInteger(t)},setter:function(t,n){return e.AttributeHelpers.coerceInteger(t)}},videoCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},photoCountDisplay:{readOnly:!0,derivedBy:["owner"],defaultFn:function(e){var t=this.getValue(e,"photoCount"),n=this.getValue(e,"videoCount"),r="";return t-=n,t===0&&n===0?r=this.intlMessage({intlName:"models.ZERO_PHOTOS"}):t===1&&n===0?r=this.intlMessage({intlName:"models.ONE_PHOTO"}):t>1&&n===0?r=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS",photos:t}):t===0&&n===1?r=this.intlMessage({intlName:"models.ONE_VIDEO"}):t===1&&n===1?r=this.intlMessage({intlName:"models.ONE_PHOTO_AND_ONE_VIDEO"}):t>1&&n===1?r=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_ONE_VIDEO",photos:t}):t===0&&n>1?r=this.intlMessage({intlName:"models.MULTIPLE_VIDEOS",videos:n}):t===1&&n>1?r=this.intlMessage({intlName:"models.ONE_PHOTO_AND_MULTIPLE_VIDEOS",videos:n}):t>1&&n>1&&(r=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_MULTIPLE_VIDEOS",photos:t,videos:n})),r}},primary:{},primaryPhotoSizes:{},bestIconURL:{readOnly:!0,derivedBy:["primaryPhotoSizes"],defaultFn:function(e){var t=this.getValue(e,"primaryPhotoSizes");return t&&t.sq?t.sq.src:undefined}},url:{readOnly:!0,derivedBy:["owner"],defaultFn:function(e){var t=this.getValue(e,"owner");return t?"/photos/"+t.getValue("pathAlias")+"/galleries/"+e+"/":undefined}},urlSuffix:{readOnly:!0,derivedBy:["owner"],defaultFn:function(e){var t=this.getValue(e,"owner"),n=t.getValue("pathAlias");return"gallery-"+n+"-"+e}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-galleries-getPhotos-fetcher","flickr-galleries-getContext-fetcher","flickr-galleries-addPhoto-creator","flickr-galleries-removePhoto-deletor","flickr-galleries-create-creator"],langBundles:["models"]});
YUI.add("photo-groups-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getAllContexts"].run(t,this.appContext)}},attributes:{id:{},groups:{isCollection:!0},total:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0}}})},"@VERSION@",{requires:["api-helper","flickr-model-registry","flickr-promise","flickr-photos-getAllContexts-fetcher"]});
